<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>System\Ajax\assets\scripts\Json.js 源码</title>
		<link href="../../assets/styles/prettify.css" type="text/css" rel="stylesheet" />
		<script src="../../assets/scripts/prettify.js" type="text/javascript"></script>
		<style type="text/css">.highlight { display: block; background-color: #ddd; }</style>
</head>
<body onload="setTimeout('prettyPrint()', 0);var node = document.getElementById(location.hash.replace(/#/, ''));if(node)node.className = 'highlight';"><pre class="prettyprint lang-js">/**
 * AJAX 传输 JSON
 * @author xuld
 */

using(&quot;System.Ajax.Base&quot;);
using(&quot;System.Data.JSON&quot;);

Ajax.accepts.json = &quot;application/json, text/javascript&quot;;
Ajax.dataParsers.json = function (xhrObject) {
    return JSON.parse(this.text(xhrObject));
};

Ajax.json = function (url, data, onsuccess, onerror) {
    if (typeof data === 'function') {
        onerror = onsuccess;
        onsuccess = data;
        data = null;
    }

    return Ajax.send({
        url: url,
        dataType: 'json',
        data: data,
        success: onsuccess,
        error: onerror
    });
};
</pre>
</body>
</html>
