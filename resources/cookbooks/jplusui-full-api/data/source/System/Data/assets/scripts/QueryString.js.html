<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>System\Data\assets\scripts\QueryString.js 源码</title>
		<link href="../../assets/styles/prettify.css" type="text/css" rel="stylesheet" />
		<script src="../../assets/scripts/prettify.js" type="text/javascript"></script>
		<style type="text/css">.highlight { display: block; background-color: #ddd; }</style>
</head>
<body onload="setTimeout('prettyPrint()', 0);var node = document.getElementById(location.hash.replace(/#/, ''));if(node)node.className = 'highlight';"><pre class="prettyprint lang-js">/**
 * @author 
 */


using(&quot;System.Ajax.Base&quot;);


var QueryString = QueryString || {};


QueryString.parse = function (value) {
	var r = {};
	if (value) {
		if (value.charAt(0) == '?') value = value.substr(1);
		value.split('&amp;').each(function(value, key) {
			value = value.split('=');
			key = decodeURIComponent(value[0]);
			try {
				r[key] = decodeURIComponent(value[1]);
			} catch (e) {
				r[key] = value[1];
			}
		});
	}


	return r;
};

<span id="stringify">/**
 * &lt;p&gt;Converts an arbitrary value to a Query String representation.&lt;/p&gt;
 *
 * &lt;p&gt;Objects with cyclical references will trigger an exception.&lt;/p&gt;
 *
 * @method stringify
 * @param obj {Variant} any arbitrary value to convert to query string
 * @param sep {String} (optional) Character that should join param k=v pairs together. Default: &quot;&amp;&quot;
 * @param eq  {String} (optional) Character that should join keys to their values. Default: &quot;=&quot;
 * @param name {String} (optional) Name of the current key, for handling children recursively.
 * @static
 */</span>
QueryString.stringify = Ajax.param;


//function (obj, name, stack) {
//	switch (typeof obj) {
//		case 'object':
//			if (obj) {
//				stack = stack || [];
//				if(stack.indexOf(obj) &gt;= 0) {
//					throw new Error(&quot;QueryString.stringify. Cyclical reference&quot;);
//				}
//				if (Array.isArray(obj)) {
//					var s = [];
//					name = name + '[]';
//					for (var i = 0, l = obj.length; i &lt; l; i++) {
//						s.push(QueryString.stringify(obj[i], name, sep, eq));
//					}
//					return s.join(sep);
//				}

//				var s = [];
//				var begin = name ? name + '[' : '';
//				var end = name ? ']' : '';
//				for (var i in obj) if (obj.hasOwnProperty(i)) {
//					var n = begin + i + end;
//					s.push(QueryString.stringify(obj[i], sep, eq, n));
//				}


//				s = s.join(sep);
//				if (!s &amp;&amp; name) return name + &quot;=&quot;;
//				return s;
//			}
//		default:
//			return encodeURIComponent(name) + &quot;=&quot; + encodeURIComponent(obj);


//	}
//};






</pre>
</body>
</html>
