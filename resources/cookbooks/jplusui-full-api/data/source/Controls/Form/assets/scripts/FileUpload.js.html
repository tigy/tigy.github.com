<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Controls\Form\assets\scripts\FileUpload.js 源码</title>
		<link href="../../assets/styles/prettify.css" type="text/css" rel="stylesheet" />
		<script src="../../assets/scripts/prettify.js" type="text/javascript"></script>
		<style type="text/css">.highlight { display: block; background-color: #ddd; }</style>
</head>
<body onload="setTimeout('prettyPrint()', 0);var node = document.getElementById(location.hash.replace(/#/, ''));if(node)node.className = 'highlight';"><pre class="prettyprint lang-js">/**
 * @author xuld
 */


imports(&quot;Controls.Button.Button&quot;);
imports(&quot;Controls.Form.FileUpload&quot;);
using(&quot;Controls.Core.Base&quot;);
using(&quot;Controls.Core.IInput&quot;);


var FileUpload = Control.extend(IInput).implement({

    xtype: 'fileupload',

    tpl: '&lt;span class=&quot;x-control&quot;&gt;\
			&lt;input type=&quot;file&quot; size=&quot;1&quot;&gt;\
			&lt;button class=&quot;x-button&quot;&gt;浏览...&lt;/button&gt;\
    	&lt;/span&gt;',

    init: function(){
        var textBox = this.prev('[type=text]') || this.next('[type=text]');
        if (textBox) {
            this.setTextBox(textBox);
        }
    },

    setTextBox: function(textBox){
        textBox = Dom.get(textBox).setAttr('readonly', true);
        this.find('[type=file]').node.onchange = function () {
            textBox.setText(this.value);
        };
    },

    state: function (name, value) {
        if (name === 'disabled' || name === 'readonly') {
            this.find('[type=file]').setAttr('disabled', value);
            this.query('.x-button').toggleClass('x-button-disabled', value);
        } else {
            IInput.state.call(name, value);
        }

        return this;
    }

});</pre>
</body>
</html>
