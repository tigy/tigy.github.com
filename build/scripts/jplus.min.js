function trace(){var t,i,n,r;if(arguments.length===0&&!trace.$count)return trace("(trace: "+trace.$count+++")");if(trace.enable){if(t=window.console,t&&console.debug&&console.debug.apply)return console.debug.apply(console,arguments);if(t&&console.log&&console.log.apply)return console.log.apply(console,arguments);for(n=0,r=[];n<arguments.length;n++)r[n]=trace.inspect(arguments[n]);return i=r.join(" "),t&&console.log?console.log(i):alert(i)}}function assert(n,t){var i,r;if(!n){i=arguments;switch(i.length){case 1:t="断言失败";case 2:break;case 0:return!0;default:r=2,t=t.replace(/\{([\w\.\(\)]*?)\}/g,function(n,t){return"参数 "+(i.length<=r?n:t+" = "+trace.ellipsis(trace.inspect(i[r++]),200))})}if(assert.stackTrace){for(i=i.callee.caller;i&&i.debugStepThrough;)i=i.caller;i&&i.caller&&(i=i.caller),i&&(t+="\r\n--------------------------------------------------------------------\r\n"+trace.ellipsis(trace.decodeUTF8(i.toString()),600))}window.trace.error(t)}return!!n}function using(n,t){var u,s,f,r,h,e,c,i,l,o;for(assert.isString(n,"using(ns): {ns} 不是合法的组件全名。"),u=using[t?"styles":"scripts"],i=0;i<u.length;i++)if(u[i]===n)return;for(u.push(n),n=using.resolve(n,t),t?(s="LINK",f="href",r=[".css"],h=using.loadStyle):(s="SCRIPT",f="src",r=[".js"],h=using.loadScript),e=document.getElementsByTagName(s),c=n.replace(/^[\.\/\\]+/,""),i=0;e[i];i++)for(l=(document.constructor?e[i][f]:e[i].getAttribute(f,4))||"",o=0;o<r.length;o++)if(l.indexOf(c+r[o])>=0)return;h(using.rootPath+n+r[0])}function imports(n){return using(n,!0)}var Deferrable,Ajax,Control,ListControl,ContentControl,TreeControl,Dialog,MessageBox,ToolTip,Draggable,BalloonTip,EmailSuggest;(function(n,t){function f(n,t){assert(n!=null,"Object.extend(dest, src): {dest} 不可为空。",n);for(var i in t)n[i]=t[i];return n}function e(n,t){assert(typeof n=="function","Array#each(fn, scope): {fn} 必须是一个函数。",n);for(var i=-1,r=this;++i<r.length;)if(n.call(t,r[i],i,r)===!1)return!1;return!0}function o(){}function s(){}function l(n,t){return t.toUpperCase()}function h(n,t){for(var i=n.constructor,r;!(r=i.$event)||!(t in r);)if(!(i=i.base))return c;return r[t]}var a=n.document,i=n.Object,r=Array.prototype,v=i.prototype.toString,y=i.prototype.hasOwnProperty,c={},u=n.JPlus={Base:o,Native:function(n){return f(n,p)},id:1,version:1},p={implement:function(n){return assert(this.prototype,"MyClass.implement(members): 无法扩展当前类，因为当前类的 prototype 为空。"),i.extend(this.prototype,n),this},implementIf:function(n){return assert(this.prototype,"MyClass.implementIf(members): 无法扩展当前类，因为当前类的 prototype 为空。"),i.extendIf(this.prototype,n),this},defineMethods:function(n,r,u){assert.isString(r,"MyClass.defineMethods(targetProperty, methods): {methods} ~");var f;return/\(\)$/.test(n)&&(f=n.substr(0,n.length-2)),this.implement(i.map(r,function(i){return function(r,u,e){var s=f?this[f]():this[n],o;return assert(s,"#"+n+" 不能为空。"),assert(!s||s[i],"#"+n+"."+i+"(): 不是函数。"),o=s[i],o=o.apply?o.apply(s,arguments):o(r,u,e),s===o||o===t?this:o}},{}),u)},addEvents:function(n,t){assert.isString(n,"MyClass.addEvents(eventName, properties): {eventName} ~");var u=this.$event||(this.$event={}),r=u.$default;return t?(i.extendIf(t,r),t.base&&(assert(r,"使用 base 字段功能必须预先定义 $default 事件。"),t.add=function(n,t,i){r.add(n,this.base,i)},t.remove=function(n,t,i){r.remove(n,this.base,i)})):t=r||c,i.map(n,t,u),this},extend:function(n){var t=n&&n.hasOwnProperty("constructor")?n.constructor:function(){arguments.callee.base.apply(this,arguments)};return s.prototype=(t.base=this).prototype,t.prototype=i.extend(new s,n),t.prototype.constructor=t,s.prototype=null,u.Native(t)}};f(i,{extend:function(){for(var n in{toString:1})return f;return u.enumerables="toString hasOwnProperty valueOf constructor isPrototypeOf".split(" "),function(n,t){if(t){assert(n!=null,"Object.extend(dest, src): {dest} 不可为空。",n);for(var r=u.enumerables.length,i;r--;)y.call(t,i=u.enumerables[r])&&(n[i]=t[i]);f(n,t)}return n}}(),extendIf:function(n,i){assert(n!=null,"Object.extendIf(dest, src): {dest} 不可为空。",n);for(var r in i)n[r]===t&&(n[r]=i[r]);return n},each:function(n,t,i){if(assert(typeof n!="function","Object.each(iterable, fn, scope): {iterable} 不能是函数。 ",n),assert(typeof t=="function","Object.each(iterable, fn, scope): {fn} 必须是函数。",t),n!=null)if(typeof n.length!="number"){for(var r in n)if(t.call(i,n[r],r,n)===!1)return!1}else return e.call(n,t,i);return!0},map:function(n,t,r){var u;return typeof n=="string"?(n=n.split(" "),u=typeof t=="function"?r?function(n,i,r){this[n]=t(n,i,r)}:t:function(n){this[n]=t}):(r=typeof n.length!="number"?{}:[],u=function(n,i,r){this[i]=t(n,i,r)}),i.each(n,u,r),r}}),Function.empty=s,String.format=function(n,t){assert(!n||n.replace,"String.format(formatString, args): {formatString} 必须是字符串。",n);var i=this;return t=arguments.length===2&&t&&typeof t=="object"?t:r.slice.call(arguments,1),n?n.replace(/\{+?(\S*?)\}+/g,function(n,r){var u=n.charAt(1)=="{",f=n.charAt(n.length-2)=="}";return u||f?n.slice(u,n.length-f):r in t?i(t[r]):""}):""},Array.isArray||(Array.isArray=function(n){return v.call(n)==="[object Array]"}),Date.now||(Date.now=function(){return+new Date}),n.Class=function(n){return o.extend(n)},n.execScript||(n.execScript=function(t){assert.isString(t,"execScript(statements): {statements} ~"),n.eval.call(n,t)}),function(n){var r=n.userAgent,t=r.match(/(IE|Firefox|Chrome|Safari|Opera)[\/\s]([\w\.]*)/i)||r.match(/(WebKit|Gecko)[\/\s]([\w\.]*)/i)||[0,"",0],i=t[1],u=!!+"\v1";n["is"+i]=n["is"+i+parseInt(t[2])]=!0,f(n,{isStd:u,isQuirks:!u&&typeof a.constructor!="object",name:i,version:t[2]})}(n.navigator),e.call([String,Array,Function,Date,o],u.Native),o.implement({dataField:function(){return this.$data||(this.$data={})},base:function(n){var i=this.constructor,t=this[n],u=t,r=arguments;assert(t,"JPlus.Base#base(fnName, args): 子类不存在 {fnName} 的属性或方法。",n),t.$bubble=!0,assert(!i||i.prototype[n],"JPlus.Base#base(fnName, args): 父类不存在 {fnName} 的方法。",n);do i=i.base,assert(i&&i.prototype[n],"JPlus.Base#base(fnName, args): 父类不存在 {fnName} 的方法。",n);while("$bubble"in(t=i.prototype[n]));assert.isFunction(t,"JPlus.Base#base(fnName, args): 父类的成员 {fn}不是一个函数。  "),t.$bubble=!0;try{return r.length<=1?t.apply(this,r.callee.caller.arguments):(r[0]=this,t.call.apply(t,r))}finally{delete t.$bubble,delete u.$bubble}},on:function(n,t,i){assert.isFunction(t,"JPlus.Base#on(eventName, eventHandler, scope): {eventHandler} ~");var r=this,e=r.dataField(),u,f;return e=e.$event||(e.$event={}),u=e[n],i=[t,i||r],u?u.handlers.push(i):(f=h(r,n),e[n]=u=function(n){for(var i=arguments.callee,r=i.handlers.slice(0),t,u=-1,f=r.length;++u<f;)if(t=r[u],t[0].call(t[1],n)===!1)return t[2]!==!0&&(t=i.stop)&&t[0].call(t[1],n),!1;return!0},u.handlers=f.initEvent?[[f.initEvent,r,!0],i]:[i],f.stopEvent&&(u.stop=[f.stopEvent,r]),f.add&&f.add(r,n,u)),r},trigger:function(n,t){var r=this,i=r.dataField().$event,u;return!i||!(i=i[n])||((u=h(r,n)).dispatch?u.dispatch(r,n,i,t):i(t))},un:function(n,t){assert(!t||typeof t=="function","JPlus.Base#un(eventName, eventHandler): {eventHandler} 必须是函数。",t);var u=this,i=u.dataField().$event,e,f,r;if(i)if(e=i[n]){if(t)for(f=e.handlers,r=f.length;r-->0;)if(f[r][0]===t){f.splice(r,1),r&&(r!==1||f[0]!==!0)||(t=0);break}t||(delete i[n],i=h(u,n),i.remove&&i.remove(u,n,e))}else if(!n)for(n in i)u.un(n);return u},once:function(n,t,i){assert.isFunction(t,"JPlus.Base#once(eventName, eventHandler): {eventHandler} ~");return this.on(n,function(){this.un(n,t).un(n,arguments.callee)}).on(n,t,i)}}),String.implementIf({trim:function(){return this.replace(/^[\s\u00A0]+|[\s\u00A0]+$/g,"")},toCamelCase:function(){return this.replace(/-(\w)/g,l)},capitalize:function(){return this.replace(/(\b[a-z])/g,l)}}),Function.implementIf({bind:function(n){var t=this;return function(){return t.apply(n,arguments)}}}),Array.implementIf({each:e,include:function(n){var t=this.indexOf(n)>=0;return t||this.push(n),t},invoke:function(n,t){assert(!t||typeof t.length=="number","Array#invoke(fnName, args): {args} 必须是参数数组。",t);var i=[];return r.forEach.call(this,function(r){assert(r!=null&&r[n]&&r[n].apply,"Array#invoke(fnName, args): {value} 不包含函数 {fnName}。",r,n),i.push(r[n].apply(r,t||[]))}),i},unique:function(){for(var t=0,n,i;t<this.length;){i=this[t],n=++t;do n=r.remove.call(this,i,n);while(n>=0)}return this},remove:function(n,t){var i=r.indexOf.call(this,n,t);return i!==-1&&r.splice.call(this,i,1),i},item:function(n){return this[n<0?this.length+n:n]},indexOf:function(n,t){t=t||0;for(var i=this.length;t<i;t++)if(this[t]===n)return t;return-1},filter:function(n,t){assert.isFunction(n,"Array#filter(fn, scope): {fn} ~");var i=[];return r.forEach.call(this,function(r,u,f){n.call(t,r,u,f)&&i.push(r)}),i},forEach:e})})(this),JPlus.Base.prototype.toString=function(){for(var n in window)if(window[n]===this.constructor)return n;return Object.prototype.toString.call(this)},function(){function n(n,t){var i=function(i,r){return assert(n(i),(r||"断言失败。").replace("~",t),i)};return i.debugStepThrough=!0,i}function t(n,t){assert(n!=null,"Object.extend(dest, src): {dest} 不可为空。",n);for(var i in t)n[i]=t[i];return n}t(trace,{enable:!0,ellipsis:function(n,t){return n.length>t?n.substr(0,t-3)+"...":n},decodeUTF8:function(n){return n.replace(/\\u([0-9a-f]{3})([0-9a-f])/gi,function(n,t,i){return String.fromCharCode(parseInt(t,16)*16+parseInt(i,16))})},inspect:function(n,t,i){var e,r,u,f;t==null&&(t=3);switch(typeof n){case"function":return t>=3?trace.decodeUTF8(n.toString()):"function ()";case"object":if(n==null)return"null";if(t<0)return n.toString();if(typeof n.length=="number"){for(r=[],u=0;u<n.length;u++)r.push(trace.inspect(n[u],++t));return i?r.join("   "):"["+r.join(", ")+"]"}if(n.setInterval&&n.resizeTo)return"window#"+n.document.URL;if(n.nodeType)return n.nodeType==9?"document "+n.URL:n.tagName?(e=n.tagName.toLowerCase(),r=e,n.id?(r+="#"+n.id,n.className&&(r+="."+n.className)):n.outerHTML?r=n.outerHTML:(n.className&&(r+=' class=".'+n.className+'"'),r="<"+r+">"+n.innerHTML+"<\/"+e+">  "),r):"[Node type="+n.nodeType+" name="+n.nodeName+" value="+n.nodeValue+"]";r="{\r\n",f=0;for(u in n)typeof n[u]!="function"?r+="\t"+u+" = "+trace.inspect(n[u],t-1)+"\r\n":f++;return f&&(r+="\t... ("+f+"个函数)\r\n"),r+"}";case"string":return t>=3?n:'"'+n+'"';case"undefined":return"undefined";default:return n.toString()}},log:function(n){trace.enable&&window.console&&console.log&&window.console.log(n)},error:function(n){if(trace.enable)if(window.console&&console.error)window.console.error(n);else throw n;},warn:function(n){trace.enable&&(window.console&&console.warn?window.console.warn(n):window.trace("[警告]"+n))},info:function(n){trace.enable&&(window.console&&console.info?window.console.info(n):window.trace.write("[信息]"+n))},dir:function(n){if(trace.enable)if(window.console&&console.dir)window.console.dir(n);else if(n){var i="",t;for(t in n)i+=t+" = "+trace.inspect(n[t],1)+"\r\n";window.trace(i)}},clear:function(){window.console&&console.clear&&window.console.clear()},eval:function(code){if(trace.enable)try{typeof code=="function"?code():eval(code)}catch(e){return e}return""},time:function(n){var i=0,r,u=+new Date,t;try{do{for(i+=10,r=10;--r>0;)n();t=+new Date-u}while(t<100)}catch(f){}window.trace("[时间] "+t/i)}}),t(assert,{stackTrace:!0,debugStepThrough:!0,deprected:function(){},isFunction:n(function(n){return typeof n=="function"},"必须是函数。"),isArray:n(function(n){return typeof n.length=="number"},"必须是数组。"),isNumber:n(function(n){return typeof n=="number"||n instanceof Number},"必须是数字。"),isString:n(function(n){return typeof n=="string"||n instanceof String},"必须是字符串。"),isDate:n(function(n){return n&&n instanceof Date},"必须是日期对象。"),isRegExp:n(function(n){return n&&n instanceof RegExp},"必须是正则表达式。"),isObject:n(function(n){return n&&(typeof n=="object"||typeof n=="function"||typeof n.nodeType=="number")},"必须是一个引用对象。"),isNode:n(function(n){return n?typeof n.nodeType=="number"||n.setTimeout:n===null},"必须是 DOM 节点。"),isElement:n(function(n){return n?typeof n.nodeType=="number"&&n.style:n===null},"必须是 DOM 元素。"),notNull:n(function(n){return n!=null},"不可为空。")}),t(using,{loadScript:function(n){var t=using.loadText(n);if(t)try{window.execScript?window.execScript(t):window.eval.call(window,t)}catch(i){}},loadStyle:function(n){return document.getElementsByTagName("HEAD")[0].appendChild(t(document.createElement("link"),{href:n,rel:"stylesheet",type:"text/css"}))},loadText:function(n){var i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t;try{if(i.open("GET",n,!1),i.send(null),t=i.status,t>=200&&t<300||t==304||t==1223)return i.responseText;throw"服务器返回状态码 "+t;}catch(r){}finally{i=null}},styles:[],scripts:[],rootPath:function(){try{var n=document.getElementsByTagName("script");return n=n[n.length-1],n=document.constructor?n.src:n.getAttribute("src",4),(n.match(/([\S\s]*\/)System\/Core\/assets\/scripts\//)||[0,""])[1]}catch(t){return""}}(),resolve:function(n,t){return n.replace(/^([^.]+\.[^.]+)\./,t?"$1.assets.styles.":"$1.assets.scripts.").replace(/\./g,"/")}})}(),function(n){function yt(n,i){return i?i===2?function(){if(this.length){var i=new t(this[0]);return i[n].apply(i,arguments)}}:i===3?function(){var t=new r;return t.add.apply(t,this.invoke(n,arguments))}:function(){for(var u=0,i,r;u<this.length&&!i;)r=new t(this[u++]),i=r[n].apply(r,arguments);return i}:function(){for(var r=0,u=this.length,i;r<u;)i=new t(this[r++]),i[n].apply(i,arguments);return this}}function pt(n,t){for(var r=0,i;i=n[r++];)t(i)}function nt(n){return assert.isNode(n,"Dom.getDocument(node): {node} ~",n),n.ownerDocument||n.document||n}function st(n,i){return!i||(typeof i=="string"?/^(?:[-\w:]|[^\x00-\xa0]|\\.)+$/.test(i)?n.tagName===i.toUpperCase():t.match(n,i):i(n))}function tt(n,i){return i=i||n,function(r){var u=this.node[i];if(r===null)return u?new t(u):u;while(u&&u.nodeType!==1)u=u[n];return u&&st(u,r)?new t(u):null}}function ht(n,t){return t=t||n,function(i){for(var u=this.node[t],f=new r;u;)(u.nodeType===1&&st(u,i)||i===null)&&f.push(u),u=u[n];return f}}function ei(n,i,r,u){if(!u&&i.removeAttribute&&i.removeAttribute("id"),i.clearAttributes&&(i.clearAttributes(),i.mergeAttributes(n),i.$data=null,n.options&&pt(n.options,function(n){i.options.seleced=n.seleced})),r!==!1&&(r=n.$data)){i.$data=r=d({},r);var f=r.$event,e;if(f){r.$event=null,e=new t(i);for(r in f)f[r].handlers.forEach(function(t){e.on(r,t[0],t[1].node===n?e:t[1])})}}(u=t.cloneFix[n.tagName])&&(typeof u=="string"?i[u]=n[u]:u(i,n))}function oi(n){n.clearAttributes&&n.clearAttributes(),new t(n).un(),n.$data=null}function si(n,t){return t?t.toUpperCase():ci}function l(n,t){return assert.isElement(n,"Dom.styleString(elem, name): {elem} ~"),n.style[t]||c(n,t)}function b(n,i){var r,u,f;if(assert.isElement(n,"Dom.styleNumber(elem, name): {elem} ~"),r=parseFloat(n.style[i]),!r&&r!==0&&(r=parseFloat(c(n,i)),!r&&r!==0))if(i in v){u={};for(f in t.displayFix)u[f]=n.style[f];d(n.style,t.displayFix),r=parseFloat(c(n,i))||0,d(n.style,u)}else r=0;return r}function wt(n,t){return n&&typeof n=="object"?n:{x:n,y:t}}function bt(n,i){var r,u=0;try{r=n.parentNode.querySelectorAll(i)}catch(f){return p(i,new t(n.parentNode)).indexOf(n)>=0||p(i,t.document).indexOf(n)>=0}while(r[u])if(r[u++]===n)return!0;return!1}function p(n,i){var b=i,l=/\\/g,u,w,f,e,a,v,y,c,o,s,h;for(n=n.trim();n;){if(w=n,u=/^(^|[#.])((?:[-\w\*]|[^\x00-\xa0]|\\.)+)/.exec(n))if(!u[1]||i[u[1]==="#"?"getElementById":"getElementsByClassName"]){n=RegExp.rightContext;switch(u[1]){case"#":i=i.getElementById(u[2]),i=i?[i]:null;break;case".":i=i.getElementsByClassName(u[2]);break;default:i=i.getElements(u[2].replace(l,""))}if(!n)return new r(i)}else i=i.getElements();else if(u=/^\s*([\s>+~<])\s*(\*|(?:[-\w*]|[^\x00-\xa0]|\\.)*)/.exec(n)){n=RegExp.rightContext,e=u[2].replace(l,"");switch(u[1]){case" ":i=i.getElements(e);break;case">":i=i.children(e);break;case"+":i=i.next(e);break;case"~":i=i.nextAll(e);break;case"<":i=i.parentAll(e);break;default:kt(u[1])}}else i=i.getElements();for(i instanceof r||(i=new r(i));u=/^([#\.:]|\[\s*)((?:[-\w]|[^\x00-\xa0]|\\.)+)/.exec(n);){n=RegExp.rightContext,e=u[2].replace(l,"");switch(u[1]){case"#":f=["id","=",e];break;case".":f=["class","~=",e];break;case":":f=t.pseudos[e]||kt(e),a=undefined,(u=/^\(\s*("([^"]*)"|'([^']*)'|[^\(\)]*(\([^\(\)]*\))?)\s*\)/.exec(n))&&(n=RegExp.rightContext,a=u[3]||u[2]||u[1]);break;default:f=[e.toLowerCase()],(u=/^\s*(?:(\S?=)\s*(?:(['"])(.*?)\2|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/.exec(n))&&(n=RegExp.rightContext,u[1]&&(f[1]=u[1],f[2]=u[3]||u[4],f[2]=f[2]?f[2].replace(/\\([0-9a-fA-F]{2,2})/g,function(n,t){return String.fromCharCode(parseInt(t,16))}).replace(l,""):""))}if(v=i,y=0,i=new r,f.call)if(f.length===3)f(a,v,i);else while(c=v[y++])f(c,a)&&i.push(c);else while(c=v[y++]){o=t.getAttr(c,f[0],1),s=f[2];switch(f[1]){case undefined:h=o!=null;break;case"=":h=o===s;break;case"~=":h=(" "+o+" ").indexOf(" "+s+" ")>=0;break;case"!=":h=o!==s;break;case"|=":h=("-"+o+"-").indexOf("-"+s+"-")>=0;break;case"^=":h=o&&o.indexOf(s)===0;break;case"$=":h=o&&o.substr(o.length-s.length)===s;break;case"*=":h=o&&o.indexOf(s)>=0;break;default:throw'Not Support Operator : "'+f[1]+'"';}h&&i.push(c)}}if(u=/^\s*,\s*/.exec(n))return n=RegExp.rightContext,i.add(p(n,b));w.length===n.length&&kt(n)}return i}function kt(n){throw new SyntaxError('An invalid or illegal string was specified : "'+n+'"!');}var g;assert(!n.Dom||n.$!==n.Dom.get,"重复引入 System.Dom.Base 模块。");var i=n.document,k=n.Object,d=k.extend,ct=Array.prototype,s=k.map,lt=navigator.isStd,t=Class({node:null,dataField:function(){return this.node.$data||(this.node.$data={})},constructor:function(n){assert.isNode(n,"Dom#constructor(node): {node} 必须是 DOM 节点。"),this.node=n},attach:function(n,t){assert(n&&n.nodeType,"Dom#attach(parentNode, refNode): {parentNode} 必须是 DOM 节点。",n),assert(t===null||t.nodeType,"Dom#attach(parentNode, refNode): {refNode} 必须是 null 或 DOM 节点 。",t),n.insertBefore(this.node,t)},detach:function(n){assert(n&&n.removeChild,"Dom#detach(parentNode): {parentNode} 必须是 DOM 节点 Dom 对象。",parent),this.node.parentNode===n&&n.removeChild(this.node)},insertBefore:function(n,t){return assert(n&&n.attach,"Dom#insertBefore(childControl, refControl): {childControl} 必须 Dom 对象。",n),n.attach(this.node,t&&t.node||null),n},removeChild:function(n){return assert(n&&n.detach,"Dom#removeChild(childControl): {childControl} 必须 Dom 对象。",n),n.detach(this.node),n},equals:function(n){return this.node===n||n&&this.node===n.node}}),r=Class({length:0,constructor:function(n){if(n)for(var i;i=n[this.length];)this[this.length++]=t.getNode(i)},item:function(n){var i=this[n<0?this.length+n:n];return i?new t(i):null},invoke:function(n,i){i=i||[];var r=[];return assert(it[n]&&it[n].apply,"DomList#invoke(fnName): {fnName} 不是 Dom 对象的方法。",n),this.forEach(function(u){u=new t(u),r.push(u[n].apply(u,i))}),r},concat:function(){return assert.deprected("DomList#concat 已过时，请改用 DomList#add"),this.add.apply(this,arguments)},add:function(){for(var r=arguments,i=0,n;i<r.length;i++)if(n=r[i],j=-1,n)for(typeof n.length!="number"&&(n=[n]);++j<n.length;)this.include(t.getNode(n[j]));return this},filter:function(n){return new r(ct.filter.call(this,typeof n=="string"?function(i){return t.match(i,n)}:n))},on:yt("on"),un:yt("un"),trigger:function(n,t){return this.invoke("trigger",[n,t]).indexOf(!1)<0}}),a=Class({constructor:function(n,t){this.x=n,this.y=t},add:function(n){return assert(n&&"x"in n&&"y"in n,"Point#add(p): {p} 必须有 'x' 和 'y' 属性。",n),new a(this.x+n.x,this.y+n.y)},sub:function(n){return assert(n&&"x"in n&&"y"in n,"Point#sub(p): {p} 必须有 'x' 和 'y' 属性。",n),new a(this.x-n.x,this.y-n.y)}}),dt=Class({constructor:function(n,t){assert.notNull(n,"Dom.Event#constructor(target, type): {target} ~"),this.target=n,this.type=t},stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.returnValue=!1},getTarget:function(){return new t(this.orignalType&&this.currentTarget||(this.target.nodeType===3?this.target.parentNode:this.target))}}),it=t.prototype,rt=dt.prototype,hi=function(){return!0},o=i.createElement("DIV"),gt={},h={stopEvent:function(n){n.stopPropagation(),n.preventDefault()},dispatch:function(n,i,r,u){n=n.node;var f=u;if((!u||!u.type)&&(u=new t.Event(n,i),f))try{d(u,f)}catch(e){}return r(u)&&(!n[i="on"+i]||n[i](u)!==!1)},add:o.addEventListener?function(n,t,i){n.node.addEventListener(t,i,!1)}:function(n,t,i){n.node.attachEvent("on"+t,i)},remove:o.removeEventListener?function(n,t,i){n.node.removeEventListener(t,i,!1)}:function(n,t,i){n.node.detachEvent("on"+t,i)}},ni=h,ti=h,ii=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,ut=/opacity=([^)]*)/,at=/-(\w)|float/g,ri=/^(?:BODY|HTML|#document)$/i,ui=/^(?:checkbox|radio)$/,u={getProp:function(n,t){return t in n?n[t]:null},setProp:function(n,t,i){"238".indexOf(n.nodeType)===-1&&(n[t]=i)},get:function(n,t){return n.getAttribute?n.getAttribute(t):this.getProp(n,t)},set:function(n,t,i){n.setAttribute?i===null?n.removeAttribute(t):n.setAttribute(t,i):this.setProp(n,t,i)}},ft={get:function(n,t,i){return i||!(t in n)?u.get(n,t):n[t]},set:function(n,t,i){t in n?n[t]=i:u.set(n,t,i)}},vt={get:function(n,t,i){var r=t in n?n[t]:u.get(n,t);return i?r?t.toLowerCase():null:!!r},set:function(n,t,i){n[t]=i}},fi={get:function(n,i,r){var f=u.get(n,i);return r||f||(n[i].nodeType&&(n=t.createNode("form")),f=n[i]),f},set:u.set},e={$default:lt?[1,"",""]:[2,"$<div>","<\/div>"],option:[2,'<select multiple="multiple">',"<\/select>"],legend:[2,"<fieldset>","<\/fieldset>"],thead:[2,"<table>","<\/table>"],tr:[3,"<table><tbody>","<\/tbody><\/table>"],td:[4,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],col:[3,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],area:[2,"<map>","<\/map>"]},v={height:function(n){return this.node.style.height=n>0?n+"px":n<=0?"0px":n,this},width:function(n){return this.node.style.width=n>0?n+"px":n<=0?"0px":n,this}},w={innerText:"innerText"in o?"innerText":"textContent"},f={maxLength:{get:ft.get,set:function(n,t,i){i||i===0?n[t]=i:u.set(n,t,null)}},selected:{get:function(n,t,i){var r=n.parentNode;return r&&(r.selectedIndex,r.parentNode&&r.parentNode.selectedIndex),t in n?i?(i===1?n[t]:n.defaultSelected)?t:null:n[t]:u.get(n,t)},set:vt.set},checked:{get:function(n,t,i){return t in n?i?(i===1?n[t]:n.defaultChecked)?t:null:n[t]:u.get(n,t)},set:vt.set},value:{get:function(n,t,i){return t in n?i!==2?n[t]:n.defaultValue:u.get(n,t)},set:ft.set},tabIndex:{get:function(n,t,i){var r=n.getAttributeNode(t);return r=r&&r.specified&&r.value||null,i?r:+r},set:ft.set}},y={},c=n.getComputedStyle?function(n,t){assert.isElement(n,"Dom.getStyle(elem, name): {elem} ~");var i=n.ownerDocument.defaultView.getComputedStyle(n,null);return i?i[t]:null}:function(n,i){var r;if(assert.isElement(n,"Dom.getStyle(elem, name): {elem} ~"),i in v)switch(i){case"height":return n.offsetHeight===0?"auto":n.offsetHeight-t.calc(n,"by+py")+"px";case"width":return n.offsetWidth===0?"auto":n.offsetWidth-t.calc(n,"bx+px")+"px";case"opacity":return ut.test(l(n,"filter"))?parseInt(RegExp.$1)/100+"":"1"}if(r=n.currentStyle,!r)return"";if(r=r[i],/^-?\d/.test(r)&&!/^-?\d+(?:px)?$/i.test(r)){var u=n.style,f=u.left,e=n.runtimeStyle.left;n.runtimeStyle.left=n.currentStyle.left,u.left=i==="fontSize"?"1em":r||0,r=u.pixelLeft+"px",u.left=f,n.runtimeStyle.left=e}return r},ci="cssFloat"in o.style?"cssFloat":"styleFloat",et,ot;if(e.optgroup=e.option,e.tbody=e.tfoot=e.colgroup=e.caption=e.thead,e.th=e.td,s("enctype encoding action method target",fi,f),s("defaultChecked defaultSelected readOnly disabled autofocus autoplay async controls hidden loop open required scoped compact noWrap isMap declare noshade multiple noresize defer useMap",vt,f),s("readOnly tabIndex defaultChecked defaultSelected accessKey useMap contentEditable maxLength",function(n){w[n.toLowerCase()]=n}),s("innerHTML innerText textContent tagName nodeName nodeType nodeValue defaultValue selectedIndex cellPadding cellSpacing rowSpan colSpan frameBorder",function(n){w[n.toLowerCase()]=n,f[n]=ft}),y.INPUT=y.SELECT=y.TEXTAREA="value",y["#text"]=y["#comment"]="nodeValue",d(t,{get:function(n){return typeof n=="string"?(n=i.getElementById(n))&&new t(n):n?n.nodeType||n.setTimeout?new t(n):n.node?new t(n.node):t.get(n[0]):null},find:function(n){return typeof n=="string"?i.find(n):t.get(n)},query:function(n){return n?typeof n=="string"?i.query(n):n.nodeType||n.setTimeout?new r([n]):typeof n.length=="number"?n instanceof r?n:new r(n):new r([t.getNode(n)]):new r},parse:function(n,i,r){return(n=t.parseNode(n,i,r))?n.nodeType?new t(n):n:null},create:function(n,i){return new t(t.createNode(n,i||""))},getNode:function(n){return n?n.nodeType||n.setTimeout?n:n.node||(typeof n=="string"?i.getElementById(n):t.getNode(n[0])):null},createNode:function(n,t){assert.isString(n,"Dom.create(tagName, className): {tagName} ~");var r=i.createElement(n);return r.className=t,r},parseNode:function(n,t,u){var f,s,o;if(typeof n=="string")if(f=n,u=u!==!1&&f.length<512,t=t&&t.ownerDocument||i,assert(t.createElement,"Dom.parseNode(html, context, cachable): {context} 必须是 DOM 节点。",t),u&&(n=gt[f])&&n.ownerDocument===t)n=n.cloneNode(!0);else{if(s=/<([!\w:]+)/.exec(f),s){for(assert.isString(f,"Dom.parseNode(html, context, cachable): {html} ~"),n=t.createElement("div"),o=e[s[1].toLowerCase()]||e.$default,n.innerHTML=o[1]+f.trim().replace(ii,"<$1><\/$2>")+o[2],navigator.isQuirks&&pt(n.getElementsByTagName("INPUT"),function(n){ui.test(n.type)&&(n.checked=n.defaultChecked)}),s=o[0];s--;)n=n.lastChild;if(assert.isNode(n,"Dom.parseNode(html, context, cachable): 无法根据 {html} 创建节点。",f),n.previousSibling){for(o=n.parentNode,n=new r,f=o.firstChild;f;f=f.nextSibling)n.push(f);u=!1}else n.parentNode.removeChild(n);u=u&&!/<(?:script|object|embed|option|style)/i.test(f)}else n=t.createTextNode(f);u&&(gt[f]=n.cloneNode(!0))}return n},match:function(n,t){if(assert.isString(t,"Dom#find(selector): selector ~。"),n.nodeType!==1)return!1;if(!n.parentNode){var r=i.createElement("div");r.appendChild(n);try{return bt(n,t)}finally{r.removeChild(n)}}return bt(n,t)},has:o.compareDocumentPosition?function(n,t){return assert.isNode(n,"Dom.has(elem, child): {elem} ~"),assert.isNode(t,"Dom.has(elem, child): {child} ~"),!!(t&&n.compareDocumentPosition(t)&16)}:function(n,t){if(assert.isNode(n,"Dom.has(elem, child): {elem} ~"),assert.isNode(t,"Dom.has(elem, child): {child} ~"),t)while(t=t.parentNode)if(n===t)return!0;return!1},getText:function(n){return assert.isNode(n,"Dom.getText(elem, name): {elem} ~"),n[y[n.nodeName]||w.innerText]||""},getAttr:function(n,t,i){assert.isNode(n,"Dom.getAttr(elem, name): {elem} ~"),t=w[t]||t;var r=f[t];return r?r.get(n,t,i):u.get(n,t.toLowerCase(),i)},hasClass:function(n,t){return assert.isNode(n,"Dom.hasClass(elem, className): {elem} ~"),assert(t&&(!t.indexOf||!/[\s\r\n]/.test(t)),"Dom.hasClass(elem, className): {className} 不能空，且不允许有空格和换行。如果需要判断 2 个 class 同时存在，可以调用两次本函数： if(hasClass('A') && hasClass('B')) ..."),(" "+n.className+" ").indexOf(" "+t+" ")>=0},$event:{},cloneFix:{INPUT:function(n,t){ui.test(n.type)?(t.defaultChecked=t.checked=n.checked,t.value!==n.value&&(t.value=n.value)):t.value=n.value},TEXTAREA:"value",OPTION:"selected",OBJECT:function(n,t){n.parentNode&&(n.outerHTML=t.outerHTML,t.innerHTML&&!n.innerHTML&&(n.innerHTML=t.innerHTML))}},attrFix:f,propFix:w,textFix:y,styleFix:v,pseudos:{target:function(n){var i=n.id||n.name,t;return i?(t=nt(n).defaultView,i===(t.defaultView||t.parentWindow).location.hash.slice(1)):!1},empty:t.isEmpty=function(n){for(n=n.firstChild;n;n=n.nextSibling)if(n.nodeType===1||n.nodeType===3)return!1;return!0},contains:function(n,i){return t.getText(n).indexOf(i)>=0},hidden:t.isHidden=function(n){return(n.style.display||c(n,"display"))==="none"},visible:function(n){return!t.isHidden(n)},not:function(n,t){return!bt(n,t)},has:function(n,i){return p(i,new t(n)).length>0},selected:function(n){return f.selected.get(n,"selected",1)},checked:function(n){return n.checked},enabled:function(n){return n.disabled===!1},disabled:function(n){return n.disabled===!0},input:function(n){return/^(input|select|textarea|button)$/i.test(n.nodeName)},"nth-child":function(n,i,r){var u=t.pseudos;u[n]?u[n](null,i,r):(n=i[n-1])&&r.push(n)},"first-child":function(n,t,i){(n=t[0])&&i.push(n)},"last-child":function(n,t,i){(n=t[t.length-1])&&i.push(n)},"only-child":function(n){var i=new t(n.parentNode).first(n.nodeName);return i&&i.next()},odd:function(n,t,i){for(var u=0,r;r=t[u++];)n&&i.push(r)},even:function(n,i,r){return t.pseudos.odd(!n,i,r)}},displayFix:{position:"absolute",visibility:"visible",display:"block"},styleNumbers:s("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom",hi,{}),window:new t(n),document:new t(i),getStyle:c,styleString:l,styleNumber:b,defaultDisplay:function(n){var o=t.displays||(t.displays={}),f=n.tagName,r=o[f],e,u;return r||(n=i.createElement(f),i.body.appendChild(n),r=c(n,"display"),i.body.removeChild(n),(r==="none"||r==="")&&(e=i.body.appendChild(t.emptyIframe||(t.emptyIframe=k.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}))),u=(e.contentWindow||e.contentDocument).document,u.write("<!doctype html><html><body>"),u.close(),n=u.body.appendChild(u.createElement(f)),r=c(n,"display"),i.body.removeChild(e)),o[f]=r),r},show:function(n){assert.isElement(n,"Dom.show(elem): {elem} ~"),n.style.display="",c(n,"display")==="none"&&(n.style.display=n.style.defaultDisplay||t.defaultDisplay(n))},hide:function(n){assert.isElement(n,"Dom.hide(elem): {elem} ~");var t=l(n,"display");t!=="none"&&(n.style.defaultDisplay=t,n.style.display="none")},calc:function(){function u(n){if(n.length===2){var t=n.charAt(0),u=n.charAt(1),f={m:"margin#",b:"border#Width",p:"padding#"},r={t:"Top",r:"Right",b:"Bottom",l:"Left"};if(t in f)t=f[t],n=u=="x"?"("+t.replace("#",r.l)+"+"+t.replace("#",r.r)+")":u=="y"?"("+t.replace("#",r.t)+"+"+t.replace("#",r.b)+")":t.replace("#",r[u]);else if(t=="s")return u=="x"?"e.offsetWidth":"e.offsetHeight"}else{if(n=="width"||n=="height")return'Dom.styleNumber(e,"'+n+'")';if(n.length<2)return n}return i.replace("#",n)}var r={},t,i;return n.getComputedStyle?(t="var c=e.ownerDocument.defaultView.getComputedStyle(e,null);return ",i='(parseFloat(c["#"])||0)'):(t="return ",i='(parseFloat(Dom.getStyle(e, "#"))||0)'),function(n,i){return assert.isElement(n,"Dom.calc(elem, type): {elem} ~"),assert.isString(i,"Dom.calc(elem, type): {type} ~"),(r[i]||(r[i]=new Function("e",t+i.replace(/\w+/g,u))))(n)}}(),movable:function(n){assert.isElement(n,"Dom.movable(elem): 参数 elem ~"),/^(?:abs|fix)/.test(l(n,"position"))||(n.style.position="relative")},getDocument:nt,implement:function(n,i,u){var o=[r,t],f,e;for(e in n)for(f=o.length;f--;)u&&o[f].prototype[e]||(o[f].prototype[e]=f?n[e]:yt(e,i));return this},implementIf:function(n,t){return this.implement(n,t,!0)},Event:dt}).implement({appendTo:function(n){return n?(n.append?n:t.get(n)).append(this):this.attach(i.body,null),this},remove:function(n){return assert(!arguments.length||n,"Dom#remove(child): {child} 不是合法的节点",n),arguments.length?typeof n=="string"?this.query(n).remove():this.removeChild(n):(n=this.parentControl||this.parent())?n.removeChild(this):this},empty:function(){for(var n=this.node;n=this.last(null);)this.removeChild(n);return this},dispose:function(){var n=this.node;return n.nodeType==1&&(pt(n.getElementsByTagName("*"),oi),oi(n)),this.remove()},setStyle:function(n,i){var r=this;if(assert.isString(n,"Dom#setStyle(name, value): {name} ~"),assert.isElement(r.node,"Dom#setStyle(name, value): 当前 dom 不支持样式"),arguments.length==1)r.node.style.cssText+=";"+n;else{if(n in v)return v[n].call(r,i);n=n.replace(at,si),assert(i||!isNaN(i),"Dom#setStyle(name, value): {value} 不是正确的属性值。",i),typeof i!="number"||n in t.styleNumbers||(i+="px")}return r.node.style[n]=i,r},show:function(){return t.show(this.node),this},hide:function(){return t.hide(this.node),this},toggle:function(){var n=arguments,i=n[n.length-1];return this[(typeof i=="boolean"?i:t.isHidden(this.node))?"show":"hide"].apply(this,n)},unselectable:"unselectable"in o?function(n){return assert.isElement(this.node,"Dom#unselectable(value): 当前 dom 不支持此操作"),this.node.unselectable=n!==!1?"on":"",this}:"onselectstart"in o?function(n){return assert.isElement(this.node,"Dom#unselectable(value): 当前 dom 不支持此操作"),this.node.onselectstart=n!==!1?function(){return!1}:null,this}:function(n){return assert.isElement(this.node,"Dom#unselectable(value): 当前 dom 不支持此操作"),this.node.style.MozUserSelect=n!==!1?"none":"",this},setAttr:function(n,t){var r=this.node,i;return n=w[n]||n,(i=f[n])||(i=u,n=n.toLowerCase()),i.set(r,n,t),this},set:function(n,t){var r=this,i,u;typeof n=="string"&&(i=n,n={},n[i]=t);for(i in n)t=n[i],r.node.style&&(i in r.node.style||at.test(i))?r.setStyle(i,t):typeof r[u="set"+i.capitalize()]=="function"?r[u](t):i in r?(u=r[i],typeof u=="function"?r[i](t):u&&u.set?u.set(t):r[i]=t):/^on(\w+)/.test(i)?t&&r.on(RegExp.$1,t):r.setAttr(i,t);return r},addClass:function(n){assert.isString(n,"Dom#addClass(className): {className} ~");var i=this.node,r=n.split(/\s+/),u,t;if(!i.className&&r.length<=1)i.className=n;else{for(u=" "+i.className+" ",t=0;t<r.length;t++)u.indexOf(" "+r[t]+" ")<0&&(u+=r[t]+" ");i.className=u.trim()}return this},removeClass:function(n){assert(!n||n.split,"Dom#removeClass(className): {className} ~");var u=this.node,i,t="",r;if(n){for(i=n.split(/\s+/),t=" "+u.className+" ",r=i.length;r--;)t=t.replace(" "+i[r]+" "," ");t=t.trim()}return u.className=t,this},toggleClass:function(n,t){return this[(t==undefined?this.hasClass(n):!t)?"removeClass":"addClass"](n)},setText:function(n){return this.node[y[this.node.nodeName]||w.innerText]=n,this},setHtml:function(n){if(/<(?:script|style)/i.test(n))return this.empty().append(n),this;var t=this.node,i=e.$default;assert(t.nodeType===1,"Dom#setHtml(value): {elem} 不是元素节点(nodeType === 1), 无法执行 setHtml。",t);try{t.innerHTML=(i[1]+n+i[2]).replace(ii,"<$1><\/$2>")}catch(r){return this.empty().append(n),this}if(i[0]>1)for(n=t.lastChild,t.removeChild(t.firstChild),t.removeChild(n);n.firstChild;)t.appendChild(n.firstChild);return this},setSize:function(n,i){var r=this,u=wt(n,i);return u.x!=null&&r.setWidth(u.x-t.calc(r.node,"bx+px")),u.y!=null&&r.setHeight(u.y-t.calc(r.node,"by+py")),r},setWidth:v.width,setHeight:v.height,setOffset:function(n){assert(n,"Dom#setOffset(offsetPoint): {offsetPoint} 必须有 'x' 和 'y' 属性。",n);var t=this.node.style;return n.y!=null&&(t.top=n.y+"px"),n.x!=null&&(t.left=n.x+"px"),this},setPosition:function(n,i){t.movable(this.node);var f=this,e=f.getPosition(),r=f.getOffset(),u=wt(n,i);return u.y!=null?r.y+=u.y-e.y:r.y=null,u.x!=null?r.x+=u.x-e.x:r.x=null,f.setOffset(r)},setScroll:function(n,t){var r=this.node,i=wt(n,t);return r.nodeType!==9?(i.x!=null&&(r.scrollLeft=i.x),i.y!=null&&(r.scrollTop=i.y)):(i.x==null&&(i.x=this.getScroll().x),i.y==null&&(i.y=this.getScroll().y),(r.defaultView||r.parentWindow).scrollTo(i.x,i.y)),this},bind:function(n,t){var i,r;if(typeof n=="string")if(i=(/^\w+/.exec(n)||[""])[0],assert(i,"Dom#bind(eventAndSelector, handler): {eventAndSelector} 中不存在事件信息。正确的 eventAndSelector 格式： click.selector"),r=n.substr(i.length))this.delegate(r,i,t);else this.on(i,t);else for(i in n)this.bind(i,n[i]);return this},submit:function(){var n=new t.Event(this.node,"submit");return this.trigger("submit",n),n.returnValue!==!1&&this.node.submit(),this},delegate:function(n,i,r){assert.isString(n,"Dom#delegate(selector, eventName, handler): {selector}  ~"),assert.isString(i,"Dom#delegate(selector, eventName, handler): {eventName}  ~"),assert.isFunction(r,"Dom#delegate(selector, eventName, handler): {handler}  ~");var s="delegate:"+i,u,e=t.$event[i],o,f=this.dataField();if(e&&e.delegate&&(i=e.delegate,o=e.initEvent),f=f.$event||(f.$event={}),u=f[s],!u){f[s]=u=function(n){for(var e=n.getTarget(),f=arguments.callee.handlers,r=[],i,u,t=0;t<f.length;t++)i=f[t],(u=e.closest(i[1]))&&(!o||o.call(u,n)!==!1)&&r.push([i[0],u]);for(t=0;t<r.length;t++)if(i=r[t],i[0].call(i[1],n)===!1){n.stopPropagation(),n.preventDefault();break}};this.on(i,u);u.handlers=[]}return u.handlers.push([r,n]),this}}).implement({getStyle:function(n){var t=this.node;return assert.isString(n,"Dom#getStyle(name): {name} ~"),assert(t.style,"Dom#getStyle(name): 当 Dom 对象对应的节点不是元素，无法使用样式。"),t.style[n=n.replace(at,si)]||c(t,n)},getAttr:function(n,i){return t.getAttr(this.node,n,i)},getText:function(){return t.getText(this.node)},getHtml:function(){return assert(this.node.nodeType===1,"Dom#getHtml(): 仅当 dom.nodeType === 1 时才能使用此函数。"),this.node.innerHTML},getSize:function(){var n=this.node,t,i;return n.nodeType!==9?(t=n.offsetWidth,i=n.offsetHeight):(n=n.documentElement,t=n.clientWidth,i=n.clientHeight),new a(t,i)},getWidth:function(){return b(this.node,"width")},getHeight:function(){return b(this.node,"height")},getScrollSize:function(){var n=this.node,t,i,r;return n.nodeType!==9?(t=n.scrollWidth,i=n.scrollHeight):(r=n.body,n=n.documentElement,t=Math.max(n.scrollWidth,r.scrollWidth,n.clientWidth),i=Math.max(n.scrollHeight,r.scrollHeight,n.clientHeight)),new a(t,i)},getOffset:function(){var i=this.node,n=l(i,"left"),t=l(i,"top");return(!n||!t||n==="auto"||t==="auto")&&l(i,"position")==="absolute"?(t=this.offsetParent(),n=this.getPosition(),ri.test(t.node.nodeName)||(n=n.sub(t.getPosition())),n.x-=b(i,"marginLeft")+b(t.node,"borderLeftWidth"),n.y-=b(i,"marginTop")+b(t.node,"borderTopWidth"),n):new a(parseFloat(n)||0,parseFloat(t)||0)},getPosition:function(){if(this.node.nodeType===9)return this.getScroll();var n=this.node,t=typeof n.getBoundingClientRect!="undefined"?n.getBoundingClientRect():{x:0,y:0},i=nt(n),r=i.documentElement,u=i.getScroll();return new a(t.left+u.x-r.clientLeft,t.top+u.y-r.clientTop)},getScroll:function(){var n=this.node,r,t,i;return n.nodeType!==9?(t=n.scrollLeft,i=n.scrollTop):"pageXOffset"in(r=n.defaultView||n.parentWindow)?(t=r.pageXOffset,i=r.pageYOffset):(n=n.documentElement,t=n.scrollLeft,i=n.scrollTop),new a(t,i)},index:function(n){for(var i=0,t=this.node;t=t.previousSibling;)(t.nodeType===1||n===!0)&&i++;return i},child:function(n){var i="firstChild",r="nextSibling",u=typeof n=="number";for(n<0&&(n=~n,i="lastChild",r="previousSibling"),i=this.node[i];i;){if(i.nodeType===1&&(u?n--<=0:st(i,n)))return new t(i);i=i[r]}return null},parent:tt("parentNode"),closest:function(n,i){for(var r=this.node;r;){if(st(r,n))return!i||t.get(i).has(r)?new t(r):null;r=r.parentNode}return null},first:tt("nextSibling","firstChild"),last:tt("previousSibling","lastChild"),next:tt("nextSibling"),prev:tt("previousSibling"),children:ht("nextSibling","firstChild"),nextAll:ht("nextSibling"),prevAll:ht("previousSibling"),parentAll:ht("parentNode"),siblings:function(n){return this.prevAll(n).add(this.nextAll(n))},offsetParent:function(){for(var n=this.node;(n=n.offsetParent)&&!ri.test(n.nodeName)&&l(n,"position")==="static";);return new t(n||nt(this.node).body)}},2).implement({getElements:function(n){var t="getElementsByTagName",i=this[t]?this:this.node;return(n=n||"*",i[t])?i[t](n):(t="querySelectorAll",i[t])?i[t](n):[]},query:function(n){var t,f,u,e;if(assert.isString(n,"Dom#find(selector): selector ~。"),assert(n,"Dom#find(selector): {selector} 不能为空。",n),t=this.node,t.nodeType!==1)return i.query.call(this,n);try{u=t.id,e=u,u||(t.id=e="__SELECTOR__",u=0),f=t.querySelectorAll("#"+e+" "+n)}catch(o){f=p(n,this)}finally{u===0&&t.removeAttribute("id")}return new r(f)},clone:function(n,t,i){var r=this.node,f=r.cloneNode(n=n!==!1);if(r.nodeType===1){if(n)for(var o=r.getElementsByTagName("*"),e=f.getElementsByTagName("*"),u=0;e[u];u++)ei(o[u],e[u],t,i);ei(r,f,t,i)}return new this.constructor(f)}},3).implement({find:function(n){var r,f,u,e;if(assert.isString(n,"Dom#find(selector): selector ~"),r=this.node,r.nodeType!==1)return i.find.call(this,n);try{u=r.id,e=u,u||(r.id=e="__SELECTOR__",u=0),f=r.querySelector("#"+e+" "+n)}catch(o){f=p(n,this)[0]}finally{u===0&&r.removeAttribute("id")}return f?new t(f):null},hasClass:function(n){return t.hasClass(this.node,n)},match:function(n){return t.match(this.node,n)},isHidden:function(){return t.isHidden(this.node)},has:function(n,i){return typeof n=="string"?i&&this.match(n)||!!this.find(n):(n=t.getNode(n),i&&this.node===n||t.has(this.node,n))}},4),k.each({append:function(n,t){return n.insertBefore(t,null)},prepend:function(n,t){return n.insertBefore(t,n.first(null))},before:function(n,t){var i=n.parentControl||n.parent();return i?i.insertBefore(t,n):null},after:function(n,t){var i=n.parentControl||n.parent();return i?i.insertBefore(t,n.next(null)):null},replaceWith:function(n,t){var i;return(i=n.parentControl||n.parent())&&(t=i.insertBefore(t,n),i.removeChild(n)),t}},function(i,u){it[u]=function(u){var e,s,o,f;if(u=t.parse(u,this)){if(u instanceof r){for(f=t.getDocument(this.node).createDocumentFragment(),s=0;s<u.length;s++)f.appendChild(u[s]);f=new t(f),e=f.getElements("SCRIPT"),navigator.isStd||(e=new r(e)),i(this,f)}else f=u,f.node.tagName==="SCRIPT"?e=[f.node]:(e=f.getElements("SCRIPT"),navigator.isStd||(e=new r(e))),u=i(this,f);for(s=0;o=e[s++];)(!o.type||/\/(java|ecma)script/i.test(o.type))&&(o.src?(assert(n.Ajax&&Ajax.send,"必须载入 System.Ajax.Script 模块以支持动态执行 <script src=''>"),Ajax.send({url:o.src,type:"GET",dataType:"script",async:!1})):n.execScript(o.text||o.textContent||o.innerHTML||""))}return u},r.prototype[u]=function(n){var i;return typeof n=="string"?i=new r(this.invoke(u,[n])):(i=new r,n=t.get(n),this.forEach(function(r){var f=n.clone();t.get(r)[u](f),i.push(f.node)})),i}}),t.defineMethods("node","scrollIntoView focus blur select click reset",1),i.node=i,i.find=function(n){assert.isString(n,"Dom#find(selector): selector ~");var i;try{i=this.querySelector(n)}catch(r){i=p(n,this)[0]}return i?new t(i):null},i.query=function(n){assert.isString(n,"Dom#find(selector): selector ~。");var t;try{t=this.querySelectorAll(n)}catch(i){t=p(n,this)}return new r(t)},ot=i.constructor,ot?(ot.$event=t.$event,ot.base=t.base):i.constructor=t,s("on un trigger once delegate dataField getElements getPosition getSize getScroll setScroll getScrollSize has",function(n){i[n]=it[n]}),s("slice splice reverse unique shift pop unshift push include indexOf each forEach",function(n,t){r.prototype[n]=t<4?function(){return new r(ct[n].apply(this,arguments))}:ct[n]}),s("$default mousewheel blur focus scroll change select submit resize error load unload touchstart touchmove touchend hashchange",h,t.$event),lt)et="DOMContentLoaded",Event.prototype.getTarget=rt.getTarget;else if(et="readystatechange",h.initEvent=function(n){n.target=n.srcElement,n.getTarget=rt.getTarget,n.stopPropagation=rt.stopPropagation,n.preventDefault=rt.preventDefault},ni={initEvent:function(n){if(!n.getTarget){h.initEvent(n),n.relatedTarget=n.fromElement===n.srcElement?n.toElement:n.fromElement;var t=nt(n.target).documentElement;n.pageX=n.clientX+(t.scrollLeft||0)-(t.clientLeft||0),n.pageY=n.clientY+(t.scrollTop||0)-(t.clientTop||0),n.layerX=n.x,n.layerY=n.y,n.which=n.button&1?1:n.button&2?3:n.button&4?2:0}}},ti={initEvent:function(n){h.initEvent(n),n.which=n.keyCode}},t.cloneFix.SCRIPT="text",v.opacity=function(n){var t=this.node,i=t.style;return assert(!+n||n<=1&&n>=0,'Dom#setStyle("opacity", value): {value} 必须在 0~1 间。',n),assert.isElement(t,"Dom#setStyle(name, value): 当前 dom 不支持样式"),n&&(n*=100),n=n||n===0?"opacity="+n:"",t=l(t,"filter"),assert(!/alpha\([^)]*\)/i.test(t)||ut.test(t),"Dom#setOpacity(value): 当前元素的 {filter} CSS属性存在不属于 alpha 的 opacity， 将导致 setOpacity 不能正常工作。",t),i.zoom=1,i.filter=ut.test(t)?t.replace(ut,n):t+" alpha("+n+")",this},u.get=function(n,t){return n.getAttributeNode?(t=n.getAttributeNode(t),t?t.value||(t.specified?"":null):null):u.getProp(n,t)},u.set=fi.set=function(n,t,i){if(n.getAttributeNode){var r=n.getAttributeNode(t);i===null?r&&(r.nodeValue="",n.removeAttributeNode(r)):r?r.nodeValue=i:n.setAttribute(t,i)}else u.setProp(n,t,i)},f.style={get:function(n){return n.style.cssText.toLowerCase()||null},set:function(n,t,i){n.style.cssText=i||""}},navigator.isQuirks){f.value={_get:f.value.get,get:function(n,t,i){return n.tagName==="BUTTON"?u.get(n,t):this._get(n,t,i)},set:function(n,t,i){n.tagName==="BUTTON"?u.set(n,t,i):n.value=i||""}},f.href=f.src=f.useMap=f.width=f.height={get:function(n,t){return n.getAttribute(t,2)},set:function(n,t,i){n.setAttribute(t,i)}},f.contentEditable={get:function(n,t){return(t=n.getAttributeNode(t))&&t.specified?t.value:null},set:function(n,t,i){i===null?n.removeAttributeNode(n.getAttributeNode(t)):u.set(n,t,i||"false")}};try{i.execCommand("BackgroundImageCache",!1,!0)}catch(ai){}}if(t.addEvents("click dblclick mousedown mouseup mouseover mouseenter mousemove mouseleave mouseout contextmenu selectstart selectend",ni),t.addEvents("keydown keypress keyup",ti),o.onfocusin===undefined&&t.addEvents("focusin focusout",{fix:function(n,t,i){var r=t==="focusin"?"focus":"blur",u=n.node.ownerDocument||n.node;u[i](r,this.handler,!0)},handler:function(n){for(var r=n.orignalType=n.type==="focus"?"focusin":"focusout",t=n.getTarget();t;){if(!t.trigger(r,n))return;t=t.parent()}i.trigger(r,n)},add:function(n,t){this.fix(n,t,"addEventListener")},remove:function(){this.fix(elem,type,"removeEventListener")}}),o.onmousewheel===undefined&&t.addEvents("mousewheel",{base:"DOMMouseScroll"}),navigator.isFirefox&&t.addEvents("click",{initEvent:function(n){return n.which===undefined||n.which===1}}),k.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(n,i){t.addEvents(i,{initEvent:function(n){if(n.type!==i){var r=n.relatedTarget;return n.orignalType=i,this.node!==r&&!t.has(this.node,r)}},base:o.onmouseenter===null?null:n,delegate:n})}),t.addEvents("focus",{delegate:"focusin"}).addEvents("blur",{delegate:"focusout"}),t.$event.domready=t.$event.domload={},s("ready load",function(n,r){var u=r?"isLoaded":"isReady";return n="dom"+n,function(f,e){var o=typeof f=="function";if(t[u])o&&f.call(e);else if(o)i.on(n,f,e);else i.body?(r?(o=t.window,f=n,t.ready()):(o=i,f=et),h.remove(o,f,arguments.callee),t[u]=!0,i.trigger(n,f)&&i.un(n)):setTimeout(arguments.callee,1);return i}},t),i.readyState!=="complete"){if(h.add(i,et,t.ready),h.add(t.window,"load",t.load,!1),!lt){g=!1;try{g=n.frameElement==null&&i.documentElement}catch(ai){}g&&g.doScroll&&function li(){if(!t.isReady){try{g.doScroll("left")}catch(n){return setTimeout(li,50)}t.ready()}}()}}else setTimeout(t.load,1);o=null,n.Dom=t,n.DomList=r,n.Point=a,n.$=n.$||t.get,n.$$=n.$$||t.query}(this),Deferrable=Class({chain:function(n,t){var i=[n,t];this._firstTask?this._lastTask[2]=i:this._firstTask=i,this._lastTask=i},progress:function(){var n=this._firstTask;return this.isRunning=!1,n&&(this._firstTask=n[2],n[0].run(n[1])),this},defer:function(n,t){var i=this.isRunning;if(this.isRunning=!0,!i)return!1;switch(t){case undefined:break;case"abort":case"stop":case"skip":return this[t](),this.isRunning=!0,!1;case"replace":this.init(this.options=Object.extend(this.options,n));case"ignore":return!0;default:assert(t==="wait","Deferred#defer(args, link): 成员 {link} 必须是 wait、abort、stop、ignore、replace 之一。",t)}return this.chain(this,n),!0},wait:function(n){return this.isRunning&&this.stop(),this.defer=n.defer.bind(n),this.progress=n.progress.bind(n),this},then:function(n,t){return this.isRunning?this.chain({owner:this,run:function(t){n.call(this.owner,t)!==!1&&this.owner.progress()}},t):n.call(this,t),this},delay:function(n){return this.run({duration:n})},pause:Function.empty,skip:function(){return this.pause(),this.progress(),this},abort:function(){return this.pause(),this._firstTask=this._lastTask=null,this.isRunning=!1,this},stop:function(){return this.abort()}}),Ajax=function(){var t,i,r=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,u=["*/"]+["*"],n;try{t=location.href}catch(f){t=document.createElement("a"),t.href="",t=t.href}return i=r.exec(t.toLowerCase())||[],n=Deferrable.extend({options:{url:t,timeout:-1},constructor:function(){},send:function(t,u){var e=this,f;return e.defer(t,u)||(t=Object.extend({owner:e,timeout:e.options.timeout},t),assert(!t.url||t.url.replace,"Ajax#run(xhrObject): {xhrObject.url} 必须是字符串。",t.url),t.url=t.url?t.url.replace(/#.*$/,""):e.options.url,t.data=t.data?typeof t.data!="string"?n.param(t.data):t.data:null,t.crossDomain==null&&(f=r.exec(t.url.toLowerCase()),t.crossDomain=!!(f&&(f[1]!=i[1]||f[2]!=i[2]||(f[3]||(f[1]==="http:"?80:443))!=(i[3]||(i[1]==="http:"?80:443))))),(n.transports[t.dataType]||n.transports.text)(t)),e},pause:function(){return this.callback&&this.callback("Aborted",-3),this}}),Object.extend(n,{send:function(t){return(new n).send(t)},transports:{},accepts:{},dataParsers:{},param:function(t,i){var r;return t&&typeof t=="object"?(r=[],Object.each(t,function(t,u){r.push(n.param(t,i?i+"["+u+"]":u))}),r=r.join("&")):r=encodeURIComponent(i)+"="+encodeURIComponent(t),r.replace(/%20/g,"+")},concatUrl:function(n,t){return t?n+(n.indexOf("?")>=0?"&":"?")+t:n},addCachePostfix:function(t){return/[?&]_=/.test(t)?t:n.concatUrl(t,"_="+Date.now()+JPlus.id++)},checkStatus:function(n){if(!n){var t=window.location.protocol;return t=="file: "||t=="chrome: "||t=="app: "}return n>=200&&n<300||n==304||n==1223},createNativeRequest:window.ActiveXObject?function(){return new ActiveXObject("Microsoft.XMLHTTP")}:function(){return new XMLHttpRequest},done:function(t,i,r,u,f,e){var o;if(i)t.errorMessage=f,o="error";else{try{f=f.call(n.dataParsers,t)}catch(s){return n.done(t,2,r,u,s.message,e)}o="success"}t.errorCode=i,t.status=r,t.statusText=u,e&&e();try{t[o]&&t[o].call(t.owner,f,t),t.complete&&t.complete.call(t.owner,i,t)}finally{t.xhr=null,t.owner.progress()}},error:function(n,t){n.xhr={readyState:4},n.errorThrown=t,n.owner.callback(t.message,-1)}}),n.dataParsers.text=function(n){var t;try{t=n.xhr.responseText}catch(i){t=""}return n.responseText=t},n.transports.text=function(t,i,r){var f={},e,o,s;t.type=t.type?t.type.toUpperCase():"GET",t.async=t.async!==!1,t.data&&t.type==="GET"&&(t.url=n.concatUrl(t.url,t.data),t.data=null),t.cache!==!0&&(t.url=n.addCachePostfix(t.url)),f.Accept=t.dataType in n.accepts?n.accepts[t.dataType]+", "+u+"; q=0.01":u,t.data&&(f["Content-Type"]="application/x-www-form-urlencoded; charset="+(t.charset||"UTF-8")),t.charset&&(f["Accept-Charset"]=value),t.crossDomain||(f["X-Requested-With"]="XMLHttpRequest");for(o in t.headers)f[o]=t.headers[o];if(t.xhr=e=n.createNativeRequest(),t.owner.callback=s=function(u,f){var e=t.xhr,s,o;try{if(!e||!f&&e.readyState!==4)return;if(e.onreadystatechange=t.owner.callback=Function.empty,f)e.readyState!==4&&e.abort(),s=f,o="";else{s=e.status;try{o=e.statusText}catch(c){o=""}n.checkStatus(s)?u=i||n.dataParsers[t.dataType]||n.dataParsers.text:(f=1,u=o)}e=null}catch(h){return n.error(t,h)}n.done(t,f,s,o,u,r)},t.start&&t.start.call(t.owner,t.data,t)===!1)return s("Prevented",-3);try{t.username?e.open(t.type,t.url,t.async,t.username,t.password):e.open(t.type,t.url,t.async)}catch(h){return n.error(t,h)}for(o in f)try{e.setRequestHeader(o,f[o])}catch(l){}try{e.send(t.data)}catch(c){return n.error(t,c)}t.async?e.readyState===4?setTimeout(s,0):(e.onreadystatechange=s,t.timeouts>0&&setTimeout(function(){s("Timeout",-2)},t.timeouts)):s()},Object.map("get post",function(t){n[t]=function(i,r,u,f,e){return typeof r=="function"&&(e=f,f=u,u=r,r=null),n.send({url:i,data:r,success:u,error:f,type:t,dataType:e})}}),n}(),Ajax.accepts.script="text/javascript, application/javascript, application/ecmascript, application/x-ecmascript",Ajax.dataParsers.script=function(n){window.execScript(this.text(n))},Ajax.transports.script=function(n,t,i){if(!n.crossDomain)return Ajax.transports.text(n,t&&function(n){return this.script(n),t(n)},i);var r,f,u;if(n.type="GET",n.cache!==!1&&(n.cache=!1,n.url=Ajax.addCachePostfix(n.url)),n.data&&(n.url=Ajax.concatUrl(n.url,n.data),n.data=null),n.xhr=r=document.createElement("SCRIPT"),n.owner.callback=u=function(r,u){var f=n.xhr;f&&(u||!f.readyState||!/in/.test(f.readyState))&&(n.owner.callback=Function.empty,f.onerror=f.onload=f.onreadystatechange=null,f.parentNode.removeChild(f),f=null,u?Ajax.done(n,u,u,"",r,i):Ajax.done(n,0,200,"OK",t||Function.empty,i))},r.src=n.url,r.type="text/javascript",r.async="async",n.charset&&(r.charset=n.charset),n.start&&n.start.call(n.owner,n.data,n)===!1)return u("Prevented",-3);r.onload=r.onreadystatechange=u,r.onerror=function(){u("Script Execute Error",2)},n.timeouts>0&&setTimeout(function(){u("Timeout",-2)},n.timeouts),f=document.getElementsByTagName("SCRIPT")[0],f.parentNode.insertBefore(r,f)},Ajax.transports.jsonp=function(n){n.jsonp===undefined&&(n.jsonp="callback");var t=n.jsonpCallback||(n.jsonpCallback="jsonp"+Date.now()+JPlus.id++),r=window[t],i;n.jsonp&&(n.url=n.url.indexOf(n.jsonp+"=?")>=0?n.url.replace(n.jsonp+"=?",n.jsonp+"="+t):Ajax.concatUrl(n.url,n.jsonp+"="+t)),window[t]=function(){i=arguments},Ajax.transports.script(n,function(){if(!i)throw new Error(t+" was not called");return i[0]},function(){window[t]=r})},Ajax.jsonp=function(n,t,i,r){return typeof t=="function"&&(r=i,i=t,t=null),Ajax.send({url:n,dataType:"jsonp",data:t,success:i,error:r})},Control=Dom.extend({xtype:"control",create:function(){return assert.isString(this.tpl,"Control#create: 无法获取或创建当前控件所关联的 DOM 节点。请为控件定义 tpl 属性或重写 create 函数。"),Dom.parseNode(this.tpl.replace(/x-control/g,"x-"+this.xtype))},init:Function.empty,constructor:function(n){var r=this,t={},i;n&&(n.constructor===Object?(Object.extend(t,n),t.node?(i=t.node,delete t.node):t.selector?(i=Dom.find(t.selector),delete t.selector):t.dom&&(i=t.dom,delete t.dom),i&&(i=Dom.getNode(i))):i=Dom.getNode(n)),r.node=i||r.create(t),assert.isNode(r.node,"Dom#constructor(options): Dom 对象的 {node} 不是节点。",r.node),r.init(t),r.set(t)}}),ListControl=Control.extend({tpl:'<ul class="x-control"/>',insertBefore:function(n,t){if(n.node.tagName!=="LI"){var i=Dom.create("LI");i.append(n),n=i}return n.attach(this.node,t&&t.node||null),n},removeChild:function(n){if(n.node.parentNode!==this.node){var t=n.parent();if(!t)return null;n.detach(t.node),n=t}return n.detach(this.node),n},add:function(){var n=arguments;return n.length===1?this.append(n[0]):(Object.each(n,this.append,this),this)},addAt:function(n,t){return this.insertBefore(Dom.parse(t),this.child(n))},removeAt:function(n){var t=this.child(n);return t?this.removeChild(t):null},set:function(n){return Array.isArray(n)?(this.empty(),this.add.apply(this,n),this):Dom.prototype.set.apply(this,arguments)},item:Dom.prototype.child,indexOf:function(n){return n&&n.parent&&this.equals(n.parent())?n.index():-1},itemOn:function(n,t,i){return this.on(n,function(n){for(var r=this.node.firstChild,u=n.target;r;r=r.nextSibling)if(r===u||Dom.has(r,u))return t.call(i||this,new Dom(r),n)})}}),ListControl.aliasMethods=function(n,t,i){n.defineMethods(t,"add addAt removeAt item"),i=i||t,n.prototype.set=function(n){if(Array.isArray(n)){var t=this[i];return t&&t.empty(),this.add.apply(this,n),this}return this.base("set")},n.prototype.removeChild=function(n){var t=this[i];return t&&n.remove(n),n.detach(this.node),n}},ContentControl=Control.extend({tpl:'<div class="x-control">\t\t\t<div class="x-control-content"><\/div>\t\t<\/div>',content:function(){return this.find("x-"+this.xtype+"-content")||new Dom(this.node)},state:function(n,t){this.toggleClass("x-"+this.xtype+"-"+n,t)}}).defineMethods("content()","setHtml getHtml setText getText"),TreeControl=ListControl.extend({createTreeItem:function(n){return new TreeControl.Item(n)},initTreeItem:function(n,t){var i=n.addClass("x-"+this.xtype+"-item").find(">ul");return t||(t=(i?i.prev()||i.prev(null):n.first()||n.first(null))||Dom.parse("")),t=this.createTreeItem(t,n),n.prepend(t),i&&t.setSubControl(i),n.dataField().item=t,t.parentControl=this,t},init:function(){for(var n=this.first();n;n=n.next())this.initTreeItem(n)},insertBefore:function(n,t){var i;return n.node.tagName!=="LI"&&(i=n,n=Dom.create("LI")),n.attach(this.node,t&&t.node||null),this.initTreeItem(n,i)},removeChild:function(n){if(n=ListControl.prototype.removeChild.call(this,n)){var t=n.dataField();delete t.item.parentControl,delete t.item}return n},item:function(n){return(n=this.child(n))&&(n=n.dataField().item),n}}),TreeControl.Item=ContentControl.extend({tpl:'<a class="x-control"><\/a>',subControl:null,createSubControl:function(n){return new TreeControl(n)},initSubControl:Function.empty,uninitSubControl:Function.empty,getSubControl:function(){return this.subControl||this.setSubControl(this.createSubControl()),this.subControl},setSubControl:function(n){return n?(n instanceof TreeControl||(n=this.createSubControl(n)),!n.closest("body")&&this.node.parentNode&&this.node.parentNode.appendChild(n.node),this.subControl=n,this.initSubControl(n),n.owner=this):this.subControl&&(this.subControl.remove(),this.uninitSubControl(this.subControl),delete this.subControl.owner,this.subControl=null),this},attach:function(n,t){n.insertBefore(this.node,t);var i=this.subControl;i&&!i.closest("body")&&n.insertBefore(i.node,t)},detach:function(n){this.node.parentNode===n&&n.removeChild(this.node);var t=this.subControl;t&&n.removeChild(t.node)}}),ListControl.aliasMethods(TreeControl.Item,"getSubControl()","subControl"),Dom.implement({pin:function(){var n={xc:function(n){n.x=n.tp.x+(n.ts.x-n.s.x)/2+n.ox},ll:function(t,i){t.x=t.tp.x-t.s.x-t.ox,i>0&&t.x<=t.dp.x&&n.rr(t,--i)},rr:function(t,i){t.x=t.tp.x+t.ts.x+t.ox,i>0&&t.x+t.s.x>=t.dp.x+t.ds.x&&n.ll(t,--i)},lr:function(t,i){t.x=t.tp.x+t.ox,i>0&&t.x+t.s.x>=t.dp.x+t.ds.x&&n.rl(t,--i)},rl:function(t,i){t.x=t.tp.x+t.ts.x-t.s.x-t.ox,i>0&&t.x<=t.dp.x&&n.lr(t,--i)},yc:function(n){n.y=n.tp.y+(n.ts.y-n.s.y)/2+n.oy},tt:function(t,i){t.y=t.tp.y-t.s.y-t.oy,i>0&&t.y<=t.dp.y&&n.bb(t,--i)},bb:function(t,i){t.y=t.tp.y+t.ts.y+t.oy,i>0&&t.y+t.s.y>=t.dp.y+t.ds.y&&n.tt(t,--i)},tb:function(t,i){t.y=t.tp.y+t.oy,i>0&&t.y+t.s.y>=t.dp.y+t.ds.y&&n.bt(t,--i)},bt:function(t,i){t.y=t.tp.y+t.ts.y-t.s.y-t.oy,i>0&&t.y<=t.dp.y&&n.tb(t,--i)}};return function(t,i,r,u,f){assert(i,"Dom#pin(ctrl, position,  offsetX, offsetY): {position} 格式不正确。正确的格式如 lt",i),t=t instanceof Dom?t:Dom.get(t);var s={s:this.getSize(),ts:t.getSize(),tp:t.getPosition(),ds:document.getSize(),dp:document.getPosition(),ox:r||0,oy:u||0},h=f===!1?0:2,e,o;return i.length<=1?i==="r"?(e="rr",o="tb"):(e="lr",o="bb"):(e=i.substr(0,2),o=i.substr(3)),assert(n[e]&&n[o],"Dom#pin(ctrl, position,  offsetX, offsetY): {position} 格式不正确。正确的格式如 lt",i),n[e](s,h),n[o](s,h),this.setPosition(s)}}()});var Menu=TreeControl.extend({xtype:"menu",showDuration:null,floating:!1,createTreeItem:function(n){if(!(n instanceof MenuItem))if(n.node.nodeType===3)if(/^\s*-\s*$/.test(n.getText()))n.remove(),n=new MenuSeperator;else{var t=n;n=new MenuItem,n.append(t)}else n=n.hasClass("x-menuseperator")?new MenuSeperator(n):new MenuItem(n);return n},init:function(){this.dataField().control=this,TreeControl.prototype.init.call(this)},show:function(){if(Dom.prototype.show.call(this,arguments,{duration:this.showDuration}),this.floating)document.once("mouseup",this.hide,this);return this.trigger("show")},hide:function(){return Dom.prototype.hide.call(this,arguments,{duration:this.showDuration}),this.hideSubMenu(),this.trigger("hide"),this},showAt:function(n,t){return this.closest("body")||this.appendTo(),this.show(),this.setPosition(n,t),this},showBy:function(n,t,i,r,u){return this.closest("body")||this.appendTo(n.parent()),this.show(),this.pin(n,t||"r",i!=null?i:-5,r!=null?r:-5,u),this},showSubMenu:function(n){if(!this.floating)document.once("mouseup",this.hideSubMenu,this);this.hideSubMenu(),n.state("hover",!0),n.subControl&&(this.currentSubMenu=n,n.subControl.showBy(n))},hideSubMenu:function(){this.currentSubMenu&&(this.currentSubMenu.subControl.hide(),this.currentSubMenu.state("hover",!1),this.currentSubMenu=null)}}),MenuItem=TreeControl.Item.extend({xtype:"menuitem",createSubControl:function(n){return new Menu(n)},initSubControl:function(n){n.hide(),n.floating=!1,this.prepend('<i class="x-menuitem-arrow"><\/i>');this.on("mouseup",this._cancelHideMenu)},uninitSubControl:function(n){n.floating=!0,this.remove("x-menuitem-arrow"),this.un("mouseup",this._cancelHideMenu)},onMouseOver:function(){this.state("hover",!0),this.subControl?this.showSubMenu():this.parentControl&&this.parentControl.hideSubMenu()},onMouseOut:function(){this.subControl||this.state("hover",!1)},init:function(){if(this.hasClass("x-"+this.xtype)){this.unselectable();this.on("mouseover",this.onMouseOver);this.on("mouseout",this.onMouseOut)}},_cancelHideMenu:function(n){n.stopPropagation()},_hideTargetMenu:function(n){for(var t=n.relatedTarget;t&&!Dom.hasClass(t,"x-menu");)t=t.parentNode;t&&new Dom(t).dataField().control.hideSubMenu()},getSubMenu:TreeControl.Item.prototype.getSubControl,setSubMenu:TreeControl.Item.prototype.setSubControl,showSubMenu:function(){return this.parentControl&&this.parentControl.showSubMenu(this),this},hideSubMenu:function(){return this.parentControl&&this.parentControl.hideSubMenu(this),this}}),MenuSeperator=MenuItem.extend({tpl:'<div class="x-menuseperator"><\/div>',init:Function.empty}),Fx=function(){function t(){for(var n=this.length;--n>=0;)this[n].step()}var n={};return Deferrable.extend({options:{duration:300,fps:50,transition:function(n){return-(Math.cos(Math.PI*n)-1)/2}},init:Function.empty,set:Function.empty,step:function(){var n=this,i=Date.now()-n.time,t=n.options;i<t.duration?n.set(t.transition(i/t.duration)):n.end(!1)},run:function(n,t){var i=this,u,r;return i.defer(n,t)||(u=i.options,i.options=n=Object.extend({transition:u.transition,fps:u.fps},n),r=n.duration,assert(r==undefined||r===0||+r,"Fx#run(options, link): {duration} 必须是数字。如果需要使用默认的时间，使用 -1 。",r),n.duration=r!==-1&&r!=undefined?r<0?-u.duration/r:r:u.duration,n.start&&n.start.call(n.target,n,i)===!1?i.progress():(i.init(n),i.set(0),i.time=0,i.resume())),i},end:function(n){var t=this;t.pause(),t.set(1);try{t.options.complete&&t.options.complete.call(t.options.target,n,t)}finally{delete t.options,t.progress()}return t},stop:function(){return this.abort(),this.end(!0),this},pause:function(){var t=this,i,r;t.timer&&(t.time=Date.now()-t.time,i=t.options.fps,r=n[i],r.remove(t),r.length===0&&(clearInterval(t.timer),delete n[i]),t.timer=0)},resume:function(){var i=this,r,u;return i.timer||(i.time=Date.now()-i.time,r=i.options.fps,u=n[r],u?(u.push(i),i.timer=u[0].timer):i.timer=setInterval(t.bind(n[r]=[i]),Math.round(1e3/r))),i}})}();Object.extend(Fx,{tweeners:{},defaultTweeners:[],numberTweener:{get:function(n,t){return Dom.styleNumber(n.node,t)},compute:function(n,t,i){return(t-n)*i+n},parse:function(n){return typeof n=="number"?n:parseFloat(n)},set:function(n,t,i){n.node.style[t]=i}},Tween:Fx.extend({constructor:function(){},set:function(n){var u=this.options,f=u.params,e=u.target,i,r,t;for(r in f)t=f[r],i=t.tweener,i.set(e,r,i.compute(t.from,t.to,n))},init:function(n){var r,t,e,f,i,u,o={};for(r in n.params){if(f=n.params[r],typeof f=="string"&&(e=/^([+-]=|(.+?)-)(.*)$/.exec(f))&&(f=e[3]),t=Fx.tweeners[r=r.toCamelCase()],!t){if(r in Dom.styleNumbers)t=Fx.numberTweener;else{for(u=Fx.defaultTweeners.length;u-->0;)if(i=Fx.defaultTweeners[u].parse(f,r),i||i===0){t=Fx.defaultTweeners[u];break}if(!t)continue}Fx.tweeners[r]=t}e?(i=e[2],u=i?t.parse(i):t.get(n.target,r),i=i?t.parse(f):u+parseFloat(e[1]==="+="?f:"-"+f)):(i=t.parse(f),u=t.get(n.target,r)),o[r]={tweener:t,from:u,to:i},assert(u!==null&&i!==null,"Fx.Tween#init(options): 无法正确获取属性 {key} 的值({from} {to})。",r,u,i)}n.params=o}}),createTweener:function(n){return Object.extendIf(n,Fx.numberTweener)}}),Object.each(Dom.styleFix,function(n,t){Fx.tweeners[t]=this},Fx.createTweener({set:function(n,t,i){Dom.styleFix[t].call(n,i)}})),Fx.tweeners.scrollTop=Fx.createTweener({set:function(n,t,i){n.setScroll(null,i)},get:function(n){return n.getScroll().y}}),Fx.tweeners.scrollLeft=Fx.createTweener({set:function(n,t,i){n.setScroll(i)},get:function(n){return n.getScroll().x}}),Fx.defaultTweeners.push(Fx.createTweener({set:navigator.isStd?function(n,t,i){n.node.style[t]=i+"px"}:function(n,t,i){try{n.node.style[t]=i}catch(r){}}})),function(){function n(n,t,i){n.orignal[i]=t.style[i],t.style[i]=Dom.styleNumber(t,i)+"px"}function r(n){var t=n[1];return t&&typeof t=="object"?n=n[0]:t=null,n=!n[0]||typeof n[0]!="object"?{duration:n[0],callback:n[1],link:n[2]}:n[0],Object.extendIf(n,t),n.effect?n.duration===undefined&&(n.duration=-1):n.effect="opacity",n.callback=n.callback||Function.empty,assert(Fx.displayEffects[n.effect],"Dom#toggle(effect, duration, callback, link): 不支持 {effect} 。",n.effect),n}var u={opacity:0},t=Fx.displayEffects={opacity:function(){return u}},f=Dom.prototype.toggle,e=Array.prototype.shift,i="height marginTop paddingTop marginBottom paddingBottom";Object.each({all:i+" opacity width",height:i,width:"width marginLeft paddingLeft marginRight paddingRight"},function(i,r){i=Object.map(i,this,{}),t[r]=function(t,u){return t.orignal.overflow=u.style.overflow,u.style.overflow="hidden",Dom.styleString(u,"display")==="inline"&&(t.orignal.display=u.style.display,u.style.display="inline-block"),r==="height"?n(t,u,"width"):r==="width"&&n(t,u,"height"),i}},function(){return 0}),Object.map("left right top bottom",function(t,i){return t="margin"+t.capitalize(),function(r,u,f){u.parentNode.style.overflow="hidden";var h={},o,e,s,c;return i<=1?(s=i===0?"marginRight":"marginLeft",o=-u.offsetWidth-Dom.styleNumber(u,s),e=Dom.styleNumber(u,t),h[t]=f?o+"-"+e:e+"-"+o,n(r,u,"width"),c=e-o,e=Dom.styleNumber(u,s),o=e+c,h[s]=f?o+"-"+e:e+"-"+o):(s=i===2?"marginBottom":"marginTop",o=-u.offsetHeight-Dom.styleNumber(u,s),e=Dom.styleNumber(u,t),h[t]=f?o+"-"+e:e+"-"+o),h}},t),Dom.implement({fx:function(){var n=this.dataField();return n.$fx||(n.$fx=new Fx.Tween)}},2).implement({animate:function(n,t,i,r){return assert.notNull(n,"Dom#animate(params, duration, oncomplete, link): {params} ~",n),n.params?r=n.link:n={params:n,duration:t,complete:i},n.target=this,assert(!n.duration||typeof n.duration=="number","Dom#animate(params, duration, callback, link): {duration} 必须是数字。如果需要制定为默认时间，使用 -1 。",n.duration),assert(!n.complete||typeof n.complete=="function","Dom#animate(params, duration, callback, link): {callback} 必须是函数",n.complete),this.fx().run(n,r),this},show:function(){var t=this,n=arguments;return n.length===0?Dom.show(t.node):(n=r(n),n.duration==null?(Dom.show(t.node),n.callback.call(t,!1,!1)):t.fx().run({target:t,duration:n.duration,start:function(i){var u=this.node,f,e,r;if(!Dom.isHidden(u))return n.callback.call(t,!0,!0),!1;Dom.show(u),i.orignal={},i.params=e={},f=Fx.displayEffects[n.effect](i,u,!0);for(r in f)i.orignal[r]=u.style[r];for(r in f)f[r]===0?(e[r]=Dom.styleNumber(u,r),u.style[r]=0):e[r]=f[r]},complete:function(i,r){Object.extend(this.node.style,r.options.orignal),n.callback.call(t,!1,i)}},n.link)),t},hide:function(){var t=this,n=arguments;return n.length===0?Dom.hide(t.node):(n=r(n),n.duration===null?(Dom.hide(t.node),n.callback.call(t,!1,!1)):t.fx().run({target:t,duration:n.duration,start:function(i){var r=this.node,f,u;if(Dom.isHidden(r))return n.callback.call(t,!1,!0),!1;i.orignal={},i.params=f=Fx.displayEffects[n.effect](i,r,!1);for(u in f)i.orignal[u]=r.style[u]},complete:function(i,r){var u=this.node;Dom.hide(u),Object.extend(u.style,r.options.orignal),n.callback.call(t,!1,i)}},n.link)),this},toggle:function(){var n=this;return n.fx().then(function(t){return f.apply(n,t),!1},arguments),n}})}();var ICollapsable={collapseDuration:-1,onCollapsing:function(){return this.trigger("collapsing")},onCollapse:function(){return this.trigger("collapse")},onExpanding:function(){return this.trigger("expanding")},onExpand:function(){return this.trigger("expand")},isCollapsed:function(){var n=this.body?this.body():this;return!n||Dom.isHidden(n.node)},toggleCollapse:function(n){return this[this.isCollapsed()?"expand":"collapse"](n)},collapse:function(){var n=this,t;return n.onCollapsing()!==!1&&(t=n.body?n.body():n)&&t.hide(arguments,{effect:"height",duration:n.collapseDuration,callback:function(){n.addClass("x-"+n.xtype+"-collapsed"),n.onCollapse()},link:"ignore"}),n},expand:function(){var n=this,t;return n.onExpanding()!==!1&&(t=n.body?n.body():n)&&(n.removeClass("x-"+n.xtype+"-collapsed"),t.show(arguments,{effect:"height",duration:n.collapseDuration,callback:function(){n.onExpand()},link:"ignore"})),n}},TreeView=TreeControl.extend({xtype:"treeview",depth:0,createTreeItem:function(n){if(!(n instanceof TreeNode)){var t=n;n=new TreeNode,n.content().append(t)}return n.setDepth(this.depth+1),this.owner&&(this.owner.update(),n.parentNode=this.owner),n},isLastNode:function(){return!1},init:function(){TreeControl.prototype.init.call(this);this.on("click",this.onClick)},invoke:function(n,t){var u=this,r,i;for(t=t||[],i=u.first();i;i=i.next())r=i.dataField().item,r[n].apply(r,t);return this},collapse:function(n){return this.invoke("collapse",[n])},collapseAll:function(n){return this.invoke("collapseAll",[n])},expand:function(n){return this.invoke("expand",[n])},expandAll:function(n){return this.invoke("expandAll",[n])},collapseTo:function(n,t){return this.invoke("collapseTo",[--n,t])},onClick:function(n){var t=n.target;if(!/\bx-treenode-(minus|plus|loading)\b/.test(t.className))return(t=new Dom(t).closest(".x-treenode"))&&(t=t.dataField().control)?(this.selectNode(t),!1):void 0},selectNode:function(n){if(this.trigger("selecting",n)){var t=this.getSelectedNode();this.setSelectedNode(n),t!==n&&this.trigger("change")}return this},setSelectedNode:function(n){return this.selectedNode&&this.selectedNode.state("selected",!1),this.selectedNode=n,n!=null&&n.state("selected",!0),this},getSelectedNode:function(){return this.selectedNode}}),TreeNode=TreeControl.Item.extend(ICollapsable).implement({xtype:"treenode",tpl:'<a class="x-control"><span><\/span><\/a>',depth:0,body:function(){return this.subControl},content:function(){return this.last("span")},createSubControl:function(n){return new TreeView(n).removeClass("x-treeview").addClass("x-treeview-subtree")},initSubControl:function(n){n.depth=this.depth,n.un("click",n.onClick)},_setSpan:function(n,t){this.each(function(i){var r=i.first(n).node;r.tagName=="SPAN"&&(r.className=t),i._setSpan(n,t)})},_markAsLastNode:function(){this.addClass("x-treenode-last"),this._setSpan(this.depth-1,"x-treenode-space x-treenode-none")},_clearMarkAsLastNode:function(){this.removeClass("x-treenode-last"),this._setSpan(this.depth-1,"x-treenode-space")},span:function(n){return this.content().prev(n)},update:function(){this.updateNodeType();var t=this.subControl.item(-1),n;t&&(n=this._lastNode,n&&n.node===t.node||(t._markAsLastNode(),this._lastNode=t,n&&n._clearMarkAsLastNode()))},updateNodeType:function(){this.setNodeType(this.subControl&&this.subControl.first()?this.isCollapsed()?"plus":"minus":"normal")},isLastNode:function(){return this.parentNode&&this.parentNode._lastNode===this},onDblClick:function(n){this.toggleCollapse(),n.preventDefault(),n.stopPropagation()},init:function(){this.unselectable();this.on("dblclick",this.onDblClick,this);this.dataField().control=this},getNodeType:function(){var n=this.span(0);return n?(/x-treenode-(.+)/.exec(n.node.className.replace(/\bx-treenode-space\b/,""))||[0,"line"])[1]:null},setNodeType:function(n){var t=this.span(0);return t&&(t.node.className="x-treenode-space x-treenode-"+n),this},onCollapse:function(){ICollapsable.onCollapse.call(this),this.updateNodeType()},onExpanding:function(){this.setNodeType(this.subControl&&this.subControl.first()?"minus":"normal"),ICollapsable.onExpanding.call(this)},onExpand:function(){this.subControl&&(this.subControl.node.style.height="auto"),ICollapsable.onExpand.call(this)},expandAll:function(n,t){return!this.subControl||t===0||(this.expand(n),this.invoke("expandAll",[n,--t])),this},collapseAll:function(n,t){return!this.subControl||t===0||(this.invoke("collapseAll",[n,--t]),this.collapse(n)),this},collapseTo:function(n,t){t=t===undefined?0:t,n=n===undefined?1:n,n>0?this.expand(t):this.collapse(t),this.invoke("collapseTo",[--n,t])},invoke:function(n,t){return this.subControl&&this.subControl.invoke(n,t),this},getDepth:function(){return this.depth},setDepth:function(n){assert(n>=0,"TreeNode#setDepth(value): {value} 必须是不小于 0 的整数",n);for(var t=this,i=t.depth,r,u=t;i>n;)t.removeChild(elem.first()),i--;while(i<n)t.prepend(Dom.createNode("span","x-treenode-space")),i++;if(t.depth=n,r=this.span(0),i)r.un("click",this.onDblClick).on("click",this.onDblClick,this);while((u=u.parentNode)&&(r=r.prev()))r.node.className=u.isLastNode()?"x-treenode-space x-treenode-none":"x-treenode-space";t.updateNodeType(),t.invoke("setDepth",[++n])},getTreeView:function(){for(var n=this;n;)n=n.parentNode;return n?n.parentControl:null},ensureVisible:function(n){for(var t=this;t=t.parentNode;)t.expand(n);return this}}),IInput={inputProxy:null,input:function(){return this.inputProxy||(this.inputProxy=/^(INPUT|SELECT|TEXTAREA|BUTTON)$/.test(this.node.tagName)?new Dom(this.node):this.find("input,select,textarea")||Dom.parse('<input type="hidden">').setAttr("name",Dom.getAttr(this.node,"name")).appendTo(this))},state:function(n,t){this.toggleClass("x-"+this.xtype+"-"+n,t)},form:function(){return new Dom(this.input().node.form)},setAttr:function(n,t){var i=this;return/^(disabled|readonly|checked|selected|actived)$/i.test(n)?(t=t!==!1,this.state(n.toLowerCase(),t),i=this.input()):/^(value|name|form)$/i.test(n)&&(i=this.input()),Dom.prototype.setAttr.call(i,n,t),this},getAttr:function(n,t){return Dom.getAttr((/^(disabled|readonly|checked|selected|actived|value|name|form)$/i.test(n)?this.input():this).node,n,t)},getText:function(){return Dom.getText(this.input().node)},setText:function(){return Dom.prototype.setText.apply(this.input(),arguments),this},select:function(){return Dom.prototype.select.apply(this.input(),arguments),this}},Button=ContentControl.extend({xtype:"button",type:"button",tpl:'<button class="x-control" type="button"><\/button>',create:function(n){return this.tpl=this.tpl.replace('type="button"','type="'+(n.type||this.type)+'"'),Control.prototype.create.call(this,n)}}).implement(IInput),IDropDownOwner={dropDown:null,dropDownWidth:-1,onDropDownShow:function(){this.trigger("dropdownshow")},onDropDownHide:function(){this.trigger("dropdownhide")},attach:function(n,t){var i=this.dropDown;i&&!i.closest("body")&&i.attach(n,t),Dom.prototype.attach.call(this,n,t)},detach:function(n){Dom.prototype.detach.call(this,n),this.dropDown&&this.dropDown.detach(n)},setDropDown:function(n){return n?(n=n instanceof Dom?n:Dom.get(n),this.dropDown=n.addClass("x-dropdown").hide(),n.closest("body")||(this.after(n),navigator.isQuirks&&(n=n.parent())&&n.getStyle("zIndex")===0&&n.setStyle("zIndex",1))):(n=this.dropDown)&&(n.remove(),this.dropDown=null),this},getDropDown:function(){return this.dropDown},isDropDownHidden:function(){return this.dropDown&&Dom.isHidden(this.dropDown.node)},toggleDropDown:function(n){return this.isDropDownHidden()?this.showDropDown(n):this.hideDropDown()},showDropDown:function(n){var t=this,r,i;if(!n||!t.getAttr("disabled")&&!t.getAttr("readonly")){if(t.isDropDownHidden()){r=t.dropDown.show().pin(t,"b",0,-1),i=t.dropDownWidth,i<0&&(i=Math.max(t.getSize().x,Dom.styleNumber(r.node,"min-width"),r.getScrollSize().x)),i!=="auto"&&r.setSize(i);document.on("mouseup",t.hideDropDown,t)}t.onDropDownShow()}return this},hideDropDown:function(n){var t=this.dropDown;if(t&&!this.isDropDownHidden()){if(n&&(n=n.target,t.node==n||this.node===n||Dom.has(t.node,n)||Dom.has(this.node,n)))return this;t.hide(),document.un("mouseup",this.hideDropDown)}return this.onDropDownHide(),this}},MenuButton=Button.extend(IDropDownOwner).implement({xtype:"menubutton",tpl:'<button class="x-button x-control" type="button"><span class="x-menubutton-arrow"><\/span><\/button>',createDropDown:function(n){if(n&&!n.hasClass("x-menu"))return n;assert(window.Menu,"必须载入 Controls.Menu.Menu 组件才能初始化 x-menu 的菜单项。");return new Menu(n).on("click",this.onDropDownClick,this)},state:function(n,t){return this.toggleClass("x-button-"+n,t)},init:function(){this.setDropDown(this.createDropDown(this.next(".x-dropdown")));this.on("click",this.toggleDropDown,this)},onDropDownShow:function(){this.state("actived",!0),Button.prototype.onDropDownShow.apply(this,arguments)},onDropDownHide:function(){this.state("actived",!1),Button.prototype.onDropDownHide.apply(this,arguments)},onDropDownClick:function(){this.hideDropDown()}});ListControl.aliasMethods(MenuButton,"dropDown");var SplitButton=MenuButton.extend({xtype:"splitbutton",tpl:'<span class="x-splitbutton x-buttongroup">\t\t\t\t<button class="x-button"><\/button>\t\t\t\t<button class="x-button"><span class="x-menubutton-arrow x-menubutton-arrow-down"><\/span><\/button>\t\t\t<\/span>',content:function(){return this.find(".x-button")},input:function(){return this.content()},state:function(n,t){return n=="disabled"?this.query(".x-button").setAttr(n,t).toggleClass("x-button-disabled",t):n=="actived"?this.last(".x-button").toggleClass("x-button-actived",t!==!1):this.base("state"),this},init:function(){this.setDropDown(this.createDropDown(this.next(".x-dropdown")));this.find(">.x-button:last-child").on("click",this.toggleDropDown,this)}}),Carousel=Control.extend({onChange:function(n,t){var r=this.find(".x-carousel-header"),i;(i=r.child(n))&&i.removeClass("x-carousel-selected"),(i=r.child(t))&&i.addClass("x-carousel-selected")},currentIndex:0,duration:-1,delay:4e3,init:function(n){var t=this,r=t.getWidth(),i=t.children=t.query(".x-carousel-body > li").hide();t.query(".x-carousel-header > li").setWidth(r/i.length).on(n.event||"mouseover",function(){t.moveTo(this.index())});i.item(0).show();t.onChange(null,0);t.start()},_slideTo:function(n,t,i){var r=this,f=r.find(".x-carousel-body"),u=r.getWidth();return r.animatingIndex==null?(r.animatingIndex=t,r.children.hide(),i||(u=-u),r.children.item(n).show().node.style.left=0,r.children.item(t).show().node.style.left=u+"px",f.animate({left:"0-"+-u},this.duration,function(){var t=r.animatingIndex,n=r.finalIndex;r.animatingIndex=null,n!=null&&n!==t&&(r.finalIndex=null,r._slideTo(t,n,t<n))})):r.finalIndex=t,t},moveTo:function(n,t){var r=this.timer,i=this.currentIndex;if(r&&clearTimeout(r),n!=i){n%=this.children.length,this.currentIndex=n;this.onChange(i,n);this._slideTo(i,n,t||i<n)}return r&&(this.timer=setTimeout(this.step,this.delay)),this},moveBy:function(n){return this.moveTo(this.currentIndex+n)},prev:function(){return this.moveBy(-1)},next:function(){return this.moveBy(1)},start:function(){var n=this;return n.timer||(n.step=function(){n.moveTo(n.currentIndex+1,!0)},n.timer=setTimeout(n.step,n.delay)),n},stop:function(){return this.timer&&(clearTimeout(this.timer),this.timer=0),this}}),ProgressBar=Control.extend({xtype:"progressbar",tpl:'<div class="x-control">                <div class="x-progressbar-fore"><\/div>            <\/div>',setValue:function(n){return this.find(".x-progressbar-fore").node.style.width=n+"%",this},getValue:function(){return parseInt(this.find(".x-progressbar-fore").node.style.width)}});Dom.keys={"13":"enter","10":"enter",up:38,down:40,left:37,right:39,esc:27,tab:9,backspace:8,"delete":46,space:32},Dom.implement({keyNav:function(n,t){var i={},r;for(r in n)i[Dom.keys[r]||r]=n[r];this.on("keydown",function(n){var t=n.keyCode;if(i[t])return i[t].call(this,n)===!0},t);if(i.enter)this.on("keypress",function(n){var t=n.keyCode;if(t===13||t===10)return i.enter.call(this,n)===!0});if(i.other)this.on("keyup",function(n){var t=n.keyCode;if(!i[t]&&!(i.enter&&(t===13||t===10)))return i.other.call(this,n)});return this}});var DropDownMenu=ListControl.extend({xtype:"listbox",_handleUpDown:function(n){if(this.isDropDownHidden())this.showDropDown();else{var t=this.dropDown._hovering;t&&(t=t[n?"next":"prev"]()),t||(t=this.dropDown[n?"first":"last"]()),this.dropDown.hovering(t)}},_handleEnter:function(){if(this.isDropDownHidden())return!0;this[this.dropDown.selectMethod](this.dropDown._hovering)},onItemClick:function(n){return this.owner[this.selectMethod](n),!1},constructor:function(n){assert(n&&n.owner&&n.selectMethod,"DropDownMenu#constructor(options): {options} 必须有 owner 和 selectMethod 字段",n);var t=this;t.owner=n.owner,t.selectMethod=n.selectMethod,t.updateMethod=n.updateMethod,t.node=n.node?Dom.getNode(n.node):t.create(),ListControl.prototype.init.apply(t,arguments),t.itemOn("mouseover",t.hovering),t.itemOn("mousedown",t.onItemClick),n.owner.keyNav({up:function(){t._handleUpDown.call(this,!1)},down:function(){t._handleUpDown.call(this,!0)},enter:t._handleEnter,esc:function(){this.hideDropDown()},other:n.updateMethod&&function(){this[this.dropDown.updateMethod]()}})},hovering:function(n){var t="x-"+this.xtype+"-hover";return this._hovering&&this._hovering.removeClass(t),this._hovering=n?n.addClass(t):null,this}}),Suggest=Control.extend(IDropDownOwner).implement({createDropDown:function(n){return new DropDownMenu({node:n,owner:this,selectMethod:"selectItem",updateMethod:"showDropDown"}).addClass("x-suggest")},onDropDownShow:function(){var t=this.getText(),n=this.getSuggestItems(t);n&&n.length&&(n.length!==1||n[0]!==t)?(this.dropDown.set(n),this.dropDown.hovering(this.dropDown.item(0))):this.hideDropDown(),IDropDownOwner.onDropDownShow.apply(this,arguments)},init:function(){var n;this.setAttr("autocomplete","off").setDropDown(this.createDropDown(this.next("x-suggest"))).on("focus",this.showDropDown).on("blur",function(){var t=this;setTimeout(function(){n||t.hideDropDown()},20)});this.dropDown.setStyle("outline","none").setAttr("tabindex",-1).on("mousedown",function(){n=!0}).on("mouseleave",function(){n=!1})},getSuggestItems:function(n){return n?(n=n.toLowerCase(),this.suggestItems.filter(function(t){return t.toLowerCase().indexOf(n)>=0})):this.suggestItems},setSuggestItems:function(n){return this.suggestItems=n||[],this},selectItem:function(n){return n&&this.setText(n.getText()).focus(),this.hideDropDown()}}),ContainerControl=Control.extend({tpl:'<div class="x-control">\t\t\t<div class="x-control-body"><\/div>\t\t<\/div>',headerTpl:'<div class="x-control-header"><h4><\/h4><\/div>',header:function(){return this.find(".x-"+this.xtype+"-header")},body:function(){return this.find(".x-"+this.xtype+"-body")||this},getTitle:function(n){var t=this.header();return t?(t.last()||t)[n?"getText":"getHtml"]():null},setTitle:function(n,t){var i=this.header(),r;return n===null?i&&i.remove():(i||(i=this.prepend(this.headerTpl.replace(/control/g,this.xtype))),r=i.last()||i,r[t?"setText":"setHtml"](n)),this},getContent:function(n){var i=this.body(),t=i.last();return(!t||t.prev())&&(t=i),t[n?"getText":"getHtml"]()},setContent:function(n,t){var i=this.body(),u="x-"+this.xtype+"-content",r=i.find(u);return r||(i.setHtml('<div class="'+u+'"><\/div>'),r=i.first()),r[t?"setText":"setHtml"](n),this},getText:function(){return this.getContent(!0)},setText:function(n){return this.setContent(n,!0)},getHtml:function(){return this.getContent(!1)},setHtml:function(n){return this.setContent(n,!1)}}),Panel=ContainerControl.extend({xtype:"panel"}),IToolTip={initialDelay:500,reshowDelay:100,menuTpl:'<span>\t    <span class="x-arrow-fore">◆<\/span>        <span class="x-arrow-back">◆<\/span>    <\/span>',showDuration:-2,show:function(){return this.closest("body")||this.appendTo(),Dom.prototype.show.call(this,arguments,{duration:this.showDuration})},hide:function(){return Dom.prototype.hide.call(this,arguments,{duration:this.showDuration})},showAt:function(n,t){return this.show().setPosition(n,t)},showBy:function(n,t,i,r){var u={left:["rr-yc",15,0],right:["ll-yc",15,0],top:["xc-bb",0,15],bottom:["xc-tt",0,15],"null":["xc-bb",0,5,1]}[this.getArrow()];return this.show().pin(n,u[0],t===undefined?u[1]:t,i===undefined?u[2]:i),u[3]&&r&&this.setPosition(r.pageX+(t||0)),this},setArrow:function(n){var t=this.find(".x-arrow")||this.append(this.menuTpl);return n?t.node.className="x-arrow x-arrow-"+n:t.remove(),this},getArrow:function(){var t=this.find(".x-arrow"),n=null;return t&&(n=(/\bx-arrow-(top|bottom|left|right)/.exec(t.node.className)||[0,n])[1]),n},setToolTip:function(n,t,i,r){n=Dom.get(n);var u=this;n.on("mouseover",function(f){var e=u.isHidden()?u.initialDelay:u.reshowDelay;u.showTimer&&clearTimeout(u.showTimer),u.showTimer=setTimeout(function(){u.showTimer=0,t&&u.setText(t),u.showBy(n,i,r,f)},e)},this);n.on("mouseout",function(){u.showTimer&&clearTimeout(u.showTimer),this.hide()},this);return this}},TextBox=Control.extend(IInput).implement({xtype:"textbox",tpl:'<input type="text" class="x-control">'}),RadioButton=Control.extend(IInput).implement({xtype:"radiobutton",tpl:'<input type="radio" class="x-control">'}),CheckBox=Control.extend(IInput).implement({xtype:"checkbox",tpl:'<input type="checkbox" class="x-control">'}),FileUpload=Control.extend(IInput).implement({xtype:"fileupload",tpl:'<span class="x-control">\t\t\t<input type="file" size="1">\t\t\t<button class="x-button">浏览...<\/button>    \t<\/span>',init:function(){var n=this.prev("[type=text]")||this.next("[type=text]");n&&this.setTextBox(n)},setTextBox:function(n){n=Dom.get(n).setAttr("readonly",!0),this.find("[type=file]").node.onchange=function(){n.setText(this.value)}},state:function(n,t){return n==="disabled"||n==="readonly"?(this.find("[type=file]").setAttr("disabled",t),this.query(".x-button").toggleClass("x-button-disabled",t)):IInput.state.call(n,t),this}}),Picker=Control.extend(IInput).implement(IDropDownOwner).implement({listMode:!0,tpl:'<span class="x-picker">\t\t\t<input type="text" class="x-textbox"/>\t\t<\/span>',menuButtonTpl:'<button class="x-button" type="button"><span class="x-menubutton-arrow"><\/span><\/button>',button:function(){return this.find("button")},updateDropDown:Function.empty,onDropDownShow:function(){this.updateDropDown(),this.state("actived",!0),IDropDownOwner.onDropDownShow.apply(this,arguments)},onDropDownHide:function(){this.state("actived",!1),IDropDownOwner.onDropDownHide.apply(this,arguments)},state:function(n,t){t=t!==!1,n=="disabled"||n=="readonly"?(this.query(".x-button,button").setAttr("disabled",t).toggleClass("x-button-disabled",t),this.input().setAttr(n,t).toggleClass("x-textbox-"+n,t)):n=="actived"?this.query(".x-button,button").toggleClass("x-button-actived",t):IInput.state.call(this,n,t)},createDropDown:function(n){return n},init:function(n){var t=this,i;t.first()||t.hasClass("x-picker")||(i=t.node,t.node=Dom.createNode("span","x-picker x-"+t.xtype),i.parentNode&&i.parentNode.replaceChild(t.node,i),t.prepend(i)),t.button()||t.append(t.menuButtonTpl),"listMode"in n?t.listMode=n.listMode:t.first().node.tagName!=="INPUT"&&(t.listMode=!0),t.setDropDown(t.createDropDown(t.next(".x-dropdown")));(t.listMode?t:t.button()).on("click",t.toggleDropDown,t);if(t.listMode&&t.input().node.tagName==="INPUT")t.on("keyup",function(){this.updateDropDown()},this)},setText:function(n){return this.input().setText(n),this.updateDropDown(),this},setWidth:function(n){var t=this.first();return n>=0&&(n-=this.getWidth()-t.getWidth()),t.setWidth(n),this}}).addEvents("change select",{add:function(n,t,i){Dom.$event.$default.add(n.input(),t,i)},remove:function(n,t,i){Dom.$event.$default.remove(n.input(),t,i)}}),SearchTextBox=Picker.extend({xtype:"searchtextbox",tpl:'<span class="x-picker">\t\t\t\t<input type="text" class="x-textbox x-searchtextbox"/>\t\t\t<\/span>',menuButtonTpl:'<button class="x-searchtextbox-search"><\/button>',onKeyDown:function(n){(n.keyCode===10||n.keyCode===13)&&this.search()},search:function(){var n=this.getText();if(n){this.onSearch(n);this.trigger("search",n)}},onSearch:Function.empty,init:function(){var n,t;this.first()||this.hasClass("x-picker")||(n=this.node,this.node=Dom.createNode("span","x-picker"),n.parentNode&&n.parentNode.replaceChild(this.node,n),this.prepend(n)),this.button()||this.append(this.menuButtonTpl),t=this.input();t.on("focus",t.select);this.button().on("click",this.search,this);t.on("keydown",this.onKeyDown,this);if(navigator.isIE6)t.on("keypress",this.onKeyDown,this)}}),ComboBox=Picker.extend({listMode:!1,xtype:"combobox",autoResize:!0,createDropDown:function(n){return new DropDownMenu({node:n,owner:this,selectMethod:"selectItem"})},updateDropDown:function(){this.dropDown.hovering(this.getSelectedItem())},init:function(){var n;this.node.tagName==="SELECT"&&(this.selectDom=n=new Dom(this.node),this.node=this.create()),this.base("init"),n&&(this.copyItemsFromSelect(n),n.hide(),n.after(this))},selectItem:function(n){var t=this,i;return t.trigger("selecting",n)&&(i=t.getText(),t.setSelectedItem(n),i!==t.getText()&&t.trigger("change"),t.hideDropDown()),t},setSelectedItem:function(n){return this.setText(n?n.getText():""),this},getSelectedItem:function(){var n=this.getText();return this.dropDown.child(function(t){return Dom.getText(t)===n})},setSelectedIndex:function(n){return this.setSelectedItem(this.dropDown.item(n))},getSelectedIndex:function(){return this.dropDown.indexOf(this.getSelectedItem())},resizeToFitItems:function(){var n=this.dropDown,t=n.getStyle("width"),i=n.getStyle("display");return n.setStyle("display","inline-block"),n.setWidth("auto"),this.first().setSize(n.getWidth()),n.setStyle("width",t),n.setStyle("display",i),this},copyItemsFromSelect:function(n){var t,i;for(this.dropDown.empty(),t=n.node.firstChild;t;t=t.nextSibling)t.tagName==="OPTION"&&(i=this.dropDown.add(Dom.getText(t)),i.dataField().option=t,t.selected&&this.setSelectedItem(i));if(n.node.onclick&&(this.node.onclick=n.node.onclick),n.node.onchange)this.on("change",n.node.onchange);this.autoResize&&this.setWidth(n.getWidth()),n.getAttr("disabled")&&this.setAttr("disabled",!0),n.getAttr("readonly")&&this.setAttr("readonly",!0)}});ListControl.aliasMethods(ComboBox,"dropDown"),Dialog=ContainerControl.extend({_centerType:3,xtype:"dialog",showDuration:-1,headerTpl:'<div class="x-control-header"><a class="x-dialog-close x-closebutton">×<\/a><h4><\/h4><\/div>',onCloseButtonClick:function(){this.close()},init:function(n){var t;this.hasClass("x-dialog")||(t=this.parent(),t&&t.hasClass("x-dialog-body")?this.node=t.node.parentNode:(t=this.node,this.node=this.create(n),this.body().append(t))),this.delegate(".x-dialog-close","click",this.onCloseButtonClick.bind(this)),this.setStyle("display","none"),this.query("script").remove()},mask:function(n){var t=this.maskDom||(this.maskDom=Dom.find(".x-mask-dialog")||Dom.create("div","x-mask x-mask-dialog").appendTo());return n===null?t.hide():(t.show(),t.setSize(document.getScrollSize()),n!=null&&t.setStyle("opacity",n)),this},setOffset:function(n){return n.x!=null&&(this._centerType&=-3,this.setStyle("margin-left",0)),n.y!=null&&(this._centerType&=-2,this.setStyle("margin-top",0)),this.base("setOffset")},setWidth:function(){return this.base("setWidth").center()},setHeight:function(){return this.base("setHeight").center()},setContent:function(){return this.base("setContent").center()},center:function(){return this._centerType&1&&this.setStyle("margin-top",-this.getHeight()/2+document.getScroll().y),this._centerType&2&&this.setStyle("margin-left",-this.getWidth()/2+document.getScroll().x),this},show:function(){return this.closest("body")||this.appendTo(),Dom.prototype.show.call(this,arguments,{duration:this.showDuration}).center()},showDialog:function(){return this.show.apply(this.mask(),arguments)},hide:function(){return this.maskDom&&this.maskDom.hide(),Dom.prototype.hide.call(this,arguments,{duration:this.showDuration})},setContentSize:function(n,t){return this.setWidth("auto"),this.body().setWidth(n).setHeight(t),this.center()},close:function(){var n=this;return this.trigger("closing")&&this.hide({callback:function(){this.trigger("close")}}),this}}),MessageBox=Dialog.extend({onCloseButtonClick:function(){this.cancel()},onOk:function(){return this.trigger("ok")},onCancel:function(){return this.trigger("cancel")},ok:function(){this.onOk()!==!1&&this.close()},cancel:function(){this.onCancel()!==!1&&this.close()},setIcon:function(n){var i=this.body(),t=i.last();return(!t||t.prev())&&(t=i),n==null?t.node.className=t.node.className.replace(/x-dialog-iconbox\s+x-dialog-iconbox-\w+/,""):t.addClass("x-dialog-iconbox x-dialog-iconbox-"+n),this},setButtons:function(n){if(n==null)this.query(".x-dialog-footer").remove();else{var i=this.find(".x-dialog-footer")||Dom.create("div","x-dialog-footer").appendTo(this),r,t,u;i.empty();for(r in n){t=n[r],u=i.append('<button class="x-button"><\/button>').setText(r);switch(typeof t){case"boolean":t=t?this.ok:this.cancel;case"function":u.on("click",t,this);break;case"object":u.set(t)}i.append("  ")}}return this}}),MessageBox.show=function(n,t,i,r){var u=MessageBox.showInstance||(MessageBox.showInstance=new MessageBox);return u.setContent(n).setTitle(t||"提示").setIcon(i||null).setButtons(r||{"确定":!0}).showDialog()},MessageBox.alert=function(n,t){return MessageBox.show(n,t,"warning")},MessageBox.confirm=function(n,t,i,r){var u=MessageBox.show(n,t,"confirm",{"确定":{className:"x-button x-button-info",onclick:function(){u.ok()}},"取消":!1});if(i)u.on("ok",i);if(r)u.on("cancel",r);return u},MessageBox.tip=function(n,t,i,r){var u=MessageBox.tipInstance||(MessageBox.tipInstance=new MessageBox);return u.setContent(n).setIcon(t).showDialog(),u.timer=setTimeout(function(){u.close(),r&&r.call(u)},i||3e3),u},ToolTip=ContentControl.extend(IToolTip).implement({xtype:"tooltip",menuTpl:'<span>\t\t\t\t<span class="x-arrow-fore">◆<\/span>\t\t\t<\/span>',content:function(){return this.find(".x-tooltip-content")}}),Draggable=Class({dragDelay:500,raiseEvent:function(n,t){return t.draggable=this,this.target.trigger(n,t)},onDragStart:function(n){if(!this.raiseEvent("dragstart",n))return!1;this.offset=this.proxy.getOffset()},onDrag:function(n){var t=this;t.raiseEvent("drag",n),t.proxy.setOffset({x:t.offset.x+t.to.x-t.from.x,y:t.offset.y+t.to.y-t.from.y})},onDragEnd:function(n){this.raiseEvent("dragend",n),this.offset=null},handlerMouseDown:function(n){if(n.which===1){Draggable.current&&Draggable.current.stopDrag(n),n.preventDefault();var t=this;t.from=new Point(n.pageX,n.pageY),t.to=new Point(n.pageX,n.pageY),t.currentHandler=t.handlerDragStart,t.timer=setTimeout(function(){t.timer=0,t.currentHandler(n)},t.dragDelay);Dom.getDocument(t.handle.node).on("mouseup",t.handlerDragStop,t).on("mousemove",t.handlerMouseMove,t)}},handlerMouseMove:function(n){n.preventDefault(),this.to.x=n.pageX,this.to.y=n.pageY,this.currentHandler(n)},handlerDragStart:function(n){var t=this;t.timer&&(clearTimeout(t.timer),t.timer=0),Draggable.current=t,t.currentHandler=t.handlerDrag,t.onDragStart(n)!==!1?(t.beforeDrag(n),t.handlerDrag(n,!0)):t.stopDragging()},handlerDrag:function(n){this.onDrag(n);this.doDrag(n)},handlerDragStop:function(n){if(n.which===1){n.preventDefault();var t=Draggable.current===this;if(this.stopDragging(),t){this.afterDrag(n);this.onDragEnd(n)}}},beforeDrag:function(){this.oldCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=this.target.getStyle("cursor"),"pointerEvents"in document.body.style?document.body.style.pointerEvents="none":document.body.setCapture&&document.body.setCapture()},doDrag:Function.empty,afterDrag:function(){document.body.style.pointerEvents==="none"?document.body.style.pointerEvents="":document.body.releaseCapture&&document.body.releaseCapture(),document.documentElement.style.cursor=this.oldCursor},constructor:function(n){Object.extend(this,n),this.handle=this.handle||this.target,this.proxy=this.proxy||this.target,this.disable(!1)},stopDragging:function(){Dom.getDocument(this.handle.node).un("mousemove",this.handlerMouseMove).un("mouseup",this.handlerDragStop),this.timer&&(clearTimeout(this.timer),this.timer=0),Draggable.current=null},disable:function(n){this.handle[n===!1?"on":"un"]("mousedown",this.handlerMouseDown,this)}}),Dom.implement({draggable:function(n){var t=this.dataField().draggable;return n!==!1?(typeof n!="object"&&(n={}),t?(Object.extend(t,n),t.disable(!1)):(n.target=this,Dom.movable(this.node),t=this.dataField().draggable=new Draggable(n))):t&&t.disable(),this}}),function(){var n=[],t=Draggable.prototype,r=window.Droppable=Class({raiseEvent:function(n,t,i){return i.draggable=t,i.droppable=this,this.target.trigger(n,i)},onDragEnter:function(n,t){return this.raiseEvent("dragenter",n,t)},onDragOver:function(n,t){return this.raiseEvent("dragover",n,t)},onDrop:function(n,t){return this.raiseEvent("drop",n,t)},onDragLeave:function(n,t){return this.raiseEvent("dragleave",n,t)},constructor:function(n){Object.extend(this,n),this.disable(!1)},init:function(){return this.lt=this.target.getPosition(),this.rb=this.lt.add(this.target.getSize()),!0},check:function(n){return this.lt.x<=n.to.x&&n.to.x<=this.rb.x&&this.lt.y<=n.to.y&&n.to.y<=this.rb.y},disable:function(t){return n[t!==!1?"remove":"include"](this),this}}),u=t.beforeDrag,f=t.afterDrag,i=Dom.$event.mousemove;Draggable.implement({beforeDrag:function(t){var i=this;u.call(i,t),i.availableDroppables=n.filter(function(n){return n.init(i)}),i.droppableFlags=new Array(i.availableDroppables.length),i.droppables=[]},doDrag:function(n){for(var t=this,i=0,f=t.droppables,e=t.availableDroppables,u=t.droppableFlags,r,o=!0;i<e.length;){if(r=e[i],o&&r.check(t))if(u[i])r.onDragOver(t,n);else u[i]=!0,o=r.onDragEnter(t,n)!==!1,f.push(r);else if(u[i]){u[i]=!1;r.onDragLeave(t,n);f.remove(r)}i++}},afterDrag:function(n){var t=this;f.call(t,n),t.droppables.forEach(function(i){i.onDrop(t,n)}),t.droppableFlags=t.availableDroppables=null}}),Dom.addEvents("dragenter dragleave dragover drop",{add:function(n,t,i){Dom.$event.$default.add(n,t,i),i=n.dataField().droppable,i?i.disable(!1):n.dataField().droppable=new r({target:n})},remove:function(n,t,i){Dom.$event.$default.remove(n,t,i),n.dataField().droppable.disable(),delete n.dataField().droppable},initEvent:i&&i.initEvent})}(),Dom.implement({popup:function(n){function r(t,i){n.target[t](),n[t]&&n[t](i)}n.constructor!==Object&&(n={target:Dom.get(n)}),n.target.hide(),n.event=n.event||"mouseenter";var i=this,t,u,f;if(/^mouse(enter|over)\b/.test(n.event)){n.delay=n.delay||300;n.target.on("mouseenter",function(){u=!0}).on("mouseleave",function(){u=!1});i.bind(n.event,function(){var i=this;f=!0,t&&clearTimeout(t),t=setTimeout(function(){t=0,r("show",i)},n.delay)}),i.bind(/^mouseenter/.test(n.event)?n.event.replace("enter","leave"):n.event.replace("over","out"),function(){var i=this;f=!1,t&&clearTimeout(t),t=setTimeout(function(){t=0,f||(u?setTimeout(arguments.callee,n.delay):r("hide",i))},n.delay)}),i.bind(n.event.replace(/^\w+/,"click"),function(n){n.preventDefault(),t&&clearTimeout(t),r("show",this)})}else/'focus(in)?\b/.test(n.event)?(i.bind(n.event,function(){r("show",this)}),i.bind(/'focusin/.test(n.event)?n.event.replace("focusin","focusout"):n.event.replace("focus","blur"),function(){r("hide",this)})):i.bind(n.event,function(t){t.preventDefault();var i=this;r("show",i);document.on("click",function(t){n.target.has(t.target,!0)||(r("hide",i),document.un("click",arguments.callee))});return!1});return i}}),String.htmlEncode=function(){function t(t,i){return n[i]}var n={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"};return function(n){return n?n.replace(/[&><"]/g,t):""}}(),location.getHash=function(){var n=location.href,t=n.indexOf("#");return t>=0?n.substr(t+1):""},function(){var t="hashchange",o=window.document,i=Dom.window,r=location.getHash,n;if(Dom[t]=function(n){n?i.on(t,n)&&n.call(i):i.trigger(t)},!("on"+t in window)||o.documentMode<8){var u,e,s=function(){i.trigger(t)},f=function(){var n=r();u!==n&&(u=n,s()),e=setTimeout(f,50)},h=function(){u=r(),e=setTimeout(f,50)},c=function(){clearTimeout(e)};navigator.isQuirks&&(h=function(){n?(u=r(),f()):Dom.ready(function(){n=Dom.parse('<iframe style="display: none" height="0" width="0" tabindex="-1" title="empty"/>');n.once("load",function(){this.on("load",function(){var f=n.contentWindow.document.body.innerText,e=r();e!=f&&(location.hash=u=f,i.trigger(t))});u=r(),f()});n=n.node,o.body.appendChild(n)})},s=function(){var f=r(),e="<html><body>"+String.htmlEncode(f)+"<\/body><\/html>",u;try{u=n.contentWindow.document,u.open(),u.write(e),u.close()}catch(o){}i.trigger(t)}),Dom.addEvents("hashchange",{add:h,remove:c})}}(),BalloonTip=ContainerControl.extend(IToolTip).implement({xtype:"balloontip"}),EmailSuggest=Suggest.extend({mails:" @126.com @139.com @163.com @gmail.com @hotmail.cn @hotmail.com @qq.com @sina.com @sohu.com @vip.163.com @vip.qq.com @yahoo.cn @yahoo.com.cn".split(" "),getSuggestItems:function(n){if(!n)return null;var t=[],i=n.indexOf("@")!==-1?n.substr(0,n.indexOf("@")):n;return this.mails.each(function(r){(i+r).indexOf(n)===0&&t.push(i+r)}),t}});
//@ sourceMappingURL=jplus.min.js.map